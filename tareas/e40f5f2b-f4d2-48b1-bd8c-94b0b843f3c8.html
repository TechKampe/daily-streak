
<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover,user-scalable=no">
<title>Misi√≥n: Cliente Contento ü•∂</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@400;600;700&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box}
html,body{width:100%;font-family:'Baloo 2',sans-serif;background:#FFFFFF;color:#1A1B2F;overflow:hidden;overscroll-behavior:none;-webkit-tap-highlight-color:transparent}
body{position:relative;padding:env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left)}
@supports(height:100svh){.scene{height:100svh}}
@supports not(height:100svh){.scene{height:100dvh}}
@supports not(height:100dvh){.scene{height:100vh}}
.scene{width:100%;display:flex;flex-direction:column;position:relative;touch-action:none;overflow:hidden}
.scene.results-view{overflow-y:auto;touch-action:auto}
.progress-bar{position:absolute;top:20px;left:20px;background:rgba(0,230,188,0.2);border-radius:20px;padding:8px 16px;font-size:clamp(12px,3vw,14px);font-weight:600;color:#00E6BC;z-index:100}
.intro-modal,.results-modal{position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(11,33,74,0.95);display:flex;align-items:center;justify-content:center;z-index:1000;padding:20px}
.modal-content{background:#FFFFFF;border-radius:24px;padding:clamp(20px,5vw,32px);max-width:500px;width:100%;max-height:90svh;overflow-y:auto;border:1px solid #00E6BC}
.modal-content h1{font-size:clamp(20px,5vw,28px);color:#1A1B2F;margin-bottom:16px;font-weight:700}
.modal-content p{font-size:clamp(14px,3.5vw,16px);color:#1A1B2F;margin-bottom:20px;line-height:1.5}
.btn-primary{background:#0B214A;color:#00E6BC;border:none;border-radius:24px;padding:16px 32px;font-size:clamp(16px,4vw,18px);font-weight:700;font-family:'Baloo 2',sans-serif;cursor:pointer;box-shadow:0 8px 18px rgba(11,33,74,0.25);width:100%;min-height:54px;touch-action:manipulation}
.btn-primary:active{transform:scale(0.98)}
.chat-container{flex:1;display:flex;flex-direction:column;overflow:hidden;padding:60px 0 0 0}
.chat-messages{flex:1;overflow-y:auto;padding:20px;display:flex;flex-direction:column;gap:16px;-webkit-overflow-scrolling:touch}
.message{display:flex;gap:12px;align-items:flex-start;animation:slideIn 0.3s ease-out}
@keyframes slideIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
.message.user{flex-direction:row-reverse}
.avatar{width:48px;height:48px;border-radius:50%;object-fit:cover;flex-shrink:0;border:2px solid #00E6BC}
.message-bubble{background:#C5FFDF;padding:12px 16px;border-radius:16px;max-width:70%;box-shadow:0 2px 8px rgba(0,0,0,0.08)}
.message.user .message-bubble{background:#0B214A;color:#00E6BC}
.message-name{font-size:12px;font-weight:600;color:#00E6BC;margin-bottom:4px}
.message.user .message-name{color:#00E6BC}
.message-text{font-size:clamp(14px,3.5vw,15px);line-height:1.4;color:#1A1B2F;display:-webkit-box;-webkit-line-clamp:10;-webkit-box-orient:vertical;overflow:hidden}
.message.user .message-text{color:#00E6BC}
.choices-container{background:#FFFFFF;padding:16px 20px;border-top:1px solid #00E6BC;display:flex;flex-direction:column;gap:12px;flex-shrink:0}
.choice-btn{background:#0B214A;color:#00E6BC;border:1px solid #00E6BC;border-radius:20px;padding:14px 20px;font-size:clamp(13px,3.2vw,15px);font-weight:600;font-family:'Baloo 2',sans-serif;cursor:pointer;text-align:left;line-height:1.3;min-height:50px;display:flex;align-items:center;transition:all 0.2s;box-shadow:0 4px 12px rgba(11,33,74,0.2);display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden}
.choice-btn:active{transform:scale(0.97)}
.results-content{padding:20px}
.results-content h2{font-size:clamp(22px,5vw,26px);color:#1A1B2F;margin-bottom:20px;font-weight:700}
.decision-item{background:#C5FFDF;border-radius:16px;padding:16px;margin-bottom:16px;border:1px solid #00E6BC}
.decision-item.correct{border-color:#04FFB4;background:rgba(4,255,180,0.1)}
.decision-item.wrong{border-color:#F9577E;background:rgba(249,87,126,0.1)}
.decision-title{font-size:clamp(14px,3.5vw,16px);font-weight:700;color:#1A1B2F;margin-bottom:8px;display:flex;align-items:center;gap:8px}
.decision-icon{font-size:18px}
.decision-text{font-size:clamp(13px,3vw,14px);color:#1A1B2F;line-height:1.5;margin-bottom:8px}
.advice-box{background:rgba(0,230,188,0.15);border-radius:16px;padding:16px;margin:20px 0;border:1px solid #00E6BC}
.advice-box h3{font-size:clamp(16px,4vw,18px);color:#00E6BC;margin-bottom:8px;font-weight:700}
.advice-box p{font-size:clamp(13px,3vw,14px);color:#1A1B2F;line-height:1.5}
.compact .progress-bar{font-size:11px;padding:6px 12px}
.compact .message-bubble{padding:10px 14px;font-size:13px}
.compact .choice-btn{padding:12px 16px;font-size:13px;min-height:46px}
</style>
</head>
<body>
<div class="scene" id="gameScene">
<div class="progress-bar" id="progressBar">1/5</div>
<div class="intro-modal" id="introModal">
<div class="modal-content">
<h1>Misi√≥n: Cliente Contento ü•∂</h1>
<p>Est√°s en tu primer aviso en solitario como t√©cnico/a de climatizaci√≥n. Llegas a casa de una clienta agobiada porque su aire ha dejado de funcionar en plena ola de calor. Tu misi√≥n es demostrar tus habilidades de comunicaci√≥n y diagn√≥stico para solucionar el problema y dejar una buena impresi√≥n.</p>
<p style="font-size:clamp(13px,3vw,14px);margin-bottom:24px">üí¨ Lee cada mensaje y elige la mejor respuesta. Tus decisiones impactar√°n en la experiencia del cliente.</p>
<button class="btn-primary" onclick="startGame()">Comenzar Misi√≥n</button>
</div>
</div>
<div class="chat-container" id="chatContainer" style="display:none">
<div class="chat-messages" id="chatMessages"></div>
<div class="choices-container" id="choicesContainer"></div>
</div>
<div class="results-modal" id="resultsModal" style="display:none">
<div class="modal-content">
<div class="results-content" id="resultsContent"></div>
</div>
</div>
</div>
<script>
const avatars={cliente:'https://techkampe.github.io/daily-streak/assets/Avatar%204_low.png',tecnico:'https://techkampe.github.io/daily-streak/assets/Avatar%202_low.png'};
const story=[
{id:1,messages:[{character:'cliente',name:'Mar√≠a (Cliente)',text:'¬°Hola! ¬øEres el t√©cnico? Menos mal que has llegado, esto es un horno...'}],choices:[
{text:'S√≠, vengo por el aire acondicionado. ¬øD√≥nde est√°?',correct:false,feedback:'Demasiado directo. La clienta est√° agobiada y necesita empat√≠a antes que soluciones t√©cnicas.'},
{text:'Buenos d√≠as, soy Ana, t√©cnica de climatizaci√≥n. Entiendo que debe ser inc√≥modo con este calor. Voy a revisarlo ahora mismo.',correct:true,feedback:'Perfecto. Te presentas, muestras empat√≠a y das seguridad. Esto genera confianza desde el primer momento.'},
{text:'Tranquila, estos aparatos siempre fallan. Vamos a verlo.',correct:false,feedback:'Minimizas el problema. Puede parecer que no tomas en serio su urgencia o que el producto es malo.'}
]},
{id:2,messages:[{character:'cliente',name:'Mar√≠a',text:'Est√° en el sal√≥n. Ayer funcionaba bien pero hoy por la ma√±ana dej√≥ de enfriar y hace un ruido raro...'}],choices:[
{text:'Vale, d√©jame verlo. Ahora te digo qu√© tiene.',correct:false,feedback:'No informas del proceso. La clienta queda fuera y puede sentirse ignorada.'},
{text:'Entendido. Voy a hacer una revisi√≥n completa: filtros, compresor y termostato. Te explico lo que encuentre, ¬øok?',correct:true,feedback:'Excelente. Explicas tu plan y la involucras. Eso tranquiliza y profesionaliza tu imagen.'},
{text:'Seguramente sea el gas. Voy a necesitar pedir piezas, esto puede tardar unos d√≠as.',correct:false,feedback:'Adelantas conclusiones sin diagn√≥stico. Genera desconfianza y alarma innecesaria.'}
]},
{id:3,messages:[{character:'cliente',name:'Mar√≠a',text:'(Tras la revisi√≥n) ¬øY? ¬øEs grave? ¬øVa a costar mucho arreglarlo?'}],choices:[
{text:'El compresor est√° roto. Hay que cambiarlo. Son 400 euros.',correct:false,feedback:'Demasiado t√©cnico y seco. La clienta no entiende qu√© es un compresor ni por qu√© cuesta eso.'},
{text:'He encontrado el problema: el compresor, que es el "coraz√≥n" del aire, ha fallado. Es necesario cambiarlo para que vuelva a enfriar. El coste ronda los 400‚Ç¨, pero incluye pieza y garant√≠a.',correct:true,feedback:'Perfecto. Usas una analog√≠a clara, explicas qu√© incluye el precio y das confianza con la garant√≠a.'},
{text:'S√≠, est√° mal. Lo arreglo hoy pero te va a salir caro.',correct:false,feedback:'Negativo y poco claro. No justificas el coste ni das opciones, solo generas rechazo.'}
]},
{id:4,messages:[{character:'cliente',name:'Mar√≠a',text:'Vale... ¬øY hay algo que pueda hacer yo para que no vuelva a pasar?'}],choices:[
{text:'Nada especial, solo llamar al servicio t√©cnico cada a√±o.',correct:false,feedback:'Pierdes la oportunidad de educar y fidelizar. Pod√≠as darle consejos √∫tiles para alargar la vida del equipo.'},
{text:'S√≠, te recomiendo limpiar o cambiar el filtro cada 3 meses, y mantener el exterior del aparato libre de polvo. Eso alarga mucho su vida √∫til.',correct:true,feedback:'Genial. Das consejos pr√°cticos y demuestras inter√©s por su bienestar a largo plazo. Eso suma puntos.'},
{text:'Estos aparatos duran lo que duran. No hay mucho que hacer.',correct:false,feedback:'Desmotivador y poco profesional. Transmites dejadez y no aportas valor.'}
]}
];
let currentStep=0;
let decisions=[];
let messageHistory=[];
function startGame(){
document.getElementById('introModal').style.display='none';
document.getElementById('chatContainer').style.display='flex';
showStep(0);
ensureFits();
}
function showStep(stepIndex){
currentStep=stepIndex;
document.getElementById('progressBar').textContent=`${stepIndex+1}/5`;
const step=story[stepIndex];
const messagesContainer=document.getElementById('chatMessages');
const choicesContainer=document.getElementById('choicesContainer');
step.messages.forEach(msg=>{
const msgEl=document.createElement('div');
msgEl.className='message';
msgEl.innerHTML=`
<img class="avatar" src="${avatars[msg.character]}" alt="${msg.name}">
<div class="message-bubble">
<div class="message-name">${msg.name}</div>
<div class="message-text">${msg.text}</div>
</div>
`;
messagesContainer.appendChild(msgEl);
messageHistory.push({character:msg.character,name:msg.name,text:msg.text});
});
messagesContainer.scrollTop=messagesContainer.scrollHeight;
choicesContainer.innerHTML='';
step.choices.forEach((choice,idx)=>{
const btn=document.createElement('button');
btn.className='choice-btn';
btn.textContent=choice.text;
btn.onclick=()=>selectChoice(stepIndex,idx,choice);
choicesContainer.appendChild(btn);
});
ensureFits();
}
function selectChoice(stepIndex,choiceIdx,choice){
decisions.push({step:stepIndex+1,choice:choice.text,correct:choice.correct,feedback:choice.feedback});
const messagesContainer=document.getElementById('chatMessages');
const userMsgEl=document.createElement('div');
userMsgEl.className='message user';
userMsgEl.innerHTML=`
<img class="avatar" src="${avatars.tecnico}" alt="T√∫">
<div class="message-bubble">
<div class="message-name">T√∫</div>
<div class="message-text">${choice.text}</div>
</div>
`;
messagesContainer.appendChild(userMsgEl);
messageHistory.push({character:'user',name:'T√∫',text:choice.text});
const reactionEl=document.createElement('div');
reactionEl.className='message';
const reactionText=choice.correct?'¬°Perfecto! As√≠ se hace üëè':'Mmm... podr√≠as haberlo enfocado mejor ü§î';
reactionEl.innerHTML=`
<img class="avatar" src="${avatars.cliente}" alt="Mar√≠a">
<div class="message-bubble">
<div class="message-name">Mar√≠a</div>
<div class="message-text">${reactionText}</div>
</div>
`;
messagesContainer.appendChild(reactionEl);
messageHistory.push({character:'cliente',name:'Mar√≠a',text:reactionText});
messagesContainer.scrollTop=messagesContainer.scrollHeight;
document.getElementById('choicesContainer').innerHTML='';
setTimeout(()=>{
if(currentStep<story.length-1){
showStep(currentStep+1);
}else{
showResults();
}
},1200);
}
function showResults(){
const scene=document.getElementById('gameScene');
scene.classList.add('results-view');
scene.style.overflow='auto';
document.getElementById('chatContainer').style.display='none';
document.getElementById('progressBar').style.display='none';
const resultsModal=document.getElementById('resultsModal');
resultsModal.style.display='flex';
const correctCount=decisions.filter(d=>d.correct).length;
let resultsHTML=`<h2>Resultados de tu misi√≥n</h2>`;
resultsHTML+=`<div style="background:rgba(0,230,188,0.15);border-radius:16px;padding:16px;margin-bottom:20px;text-align:center;border:1px solid #00E6BC">
<div style="font-size:clamp(32px,8vw,40px);font-weight:700;color:#00E6BC">${correctCount}/${decisions.length}</div>
<div style="font-size:clamp(14px,3.5vw,16px);color:#1A1B2F;margin-top:4px">Respuestas √≥ptimas</div>
</div>`;
decisions.forEach((d,i)=>{
const className=d.correct?'correct':'wrong';
const icon=d.correct?'‚úì':'‚úó';
resultsHTML+=`<div class="decision-item ${className}">
<div class="decision-title"><span class="decision-icon">${icon}</span> Interacci√≥n ${d.step}</div>
<div class="decision-text"><strong>Tu respuesta:</strong> ${d.choice}</div>
<div class="decision-text"><strong>An√°lisis:</strong> ${d.feedback}</div>
</div>`;
});
resultsHTML+=`<div class="advice-box">
<h3>üí° Consejo profesional</h3>
<p>La comunicaci√≥n clara y emp√°tica es clave en oficios t√©cnicos. Explica lo que haces, usa lenguaje sencillo y muestra inter√©s genuino. Un cliente contento es un cliente que repite y recomienda.</p>
</div>`;
resultsHTML+=`<button class="btn-primary" onclick="completeTask()" style="margin-top:20px">Ver mi recompensa</button>`;
document.getElementById('resultsContent').innerHTML=resultsHTML;
}
function completeTask(){
if(window.ReactNativeWebView){
window.ReactNativeWebView.postMessage(JSON.stringify({action:'TASK_COMPLETED'}));
}
}
function ensureFits(){
const scene=document.getElementById('gameScene');
if(scene.classList.contains('results-view'))return;
const chatContainer=document.getElementById('chatContainer');
if(!chatContainer||chatContainer.style.display==='none')return;
if(scene.scrollHeight>scene.clientHeight+5){
scene.classList.add('compact');
}
}
window.addEventListener('resize',ensureFits);
window.addEventListener('orientationchange',()=>setTimeout(ensureFits,200));
</script>
</body>
</html>

