<!DOCTYPE html><html lang="es"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover,maximum-scale=1,user-scalable=no"/><link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@400;600;700&display=swap" rel="stylesheet"><title>¡No te chispotees! ⚡️</title><style>
:root{--c-bg:#fff;--c-text:#1A1B2F;--c-accent:#00E6BC;--c-btn:#0B214A;--c-ok:#04FFB4;--c-err:#F9577E;--c-info:#C5FFDF;--gap:16px;--ui-scale:1}
*{box-sizing:border-box;-webkit-tap-highlight-color:transparent}
html,body{height:100%;background:#fff;color:var(--c-text);font-family:"Baloo 2",system-ui,-apple-system,Segoe UI,Roboto,sans-serif;overscroll-behavior:none;overflow:hidden}
html.results-mode,body.results-mode{overflow-y:auto;overscroll-behavior:auto}
.scene{position:relative;display:flex;justify-content:flex-start;align-items:stretch;touch-action:none;transform:translateZ(0);padding:calc(env(safe-area-inset-top) + 80px) calc(16px + 100px) calc(env(safe-area-inset-bottom) + 16px) 16px;gap:12px;background:#fff}
@supports(height:100svh){.scene{height:100svh}}
@supports not (height:100svh){@supports(height:100dvh){.scene{height:100dvh}}}
@supports not (height:100dvh){.scene{height:100vh}}
.uiRoot{position:relative;transform-origin:top left;transform:scale(var(--ui-scale));width:calc(100%/var(--ui-scale));height:calc(100%/var(--ui-scale));display:flex;flex-direction:column;gap:8px}
.safe-spot{position:absolute;top:0;right:0;width:100px;height:100px;pointer-events:none}
.avatar{position:absolute;left:8px;bottom:8px;width:120px;opacity:.09;filter:saturate(0.9) drop-shadow(0 6px 18px rgba(0,0,0,.1));z-index:0}
.hud{z-index:2;display:flex;flex-direction:column;gap:6px}
.title{margin:0;font-weight:700;letter-spacing:.2px;color:var(--c-text);font-size:clamp(18px,4.5vw,28px);line-height:1.05;max-width:85%;text-wrap:balance}
.badge{display:inline-block;font-size:12px;color:var(--c-btn);background:var(--c-info);border:1px solid var(--c-accent);border-radius:12px;padding:4px 8px}
.progressWrap{display:flex;align-items:center;gap:8px}
.progressText{font-size:13px;color:var(--c-accent);min-width:44px;text-align:center}
.pbar{flex:1;height:6px;background:#E9FBF5;border-radius:999px;overflow:hidden;border:1px solid var(--c-accent)}
.pfill{height:100%;width:0;background:linear-gradient(90deg,#00E6BC,#04FFB4);transition:width .35s ease;border-right:1px solid #00e6bc}
.content{z-index:2;display:flex;flex-direction:column;gap:12px;flex:1;min-height:0}
.question{font-weight:600;font-size:clamp(16px,4.2vw,22px);line-height:1.15;padding-top:4px;display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden;text-overflow:ellipsis}
.options{margin-top:4px;display:grid;grid-template-columns:1fr;gap:10px}
.opt{height:56px;min-height:56px;display:flex;align-items:center;justify-content:center;text-align:center;padding:6px 14px;border-radius:24px;border:1px solid var(--c-accent);background:var(--c-btn);color:var(--c-accent);font-weight:700;font-size:clamp(14px,3.8vw,18px);box-shadow:0 8px 18px rgba(11,33,74,.25);cursor:pointer;transition:transform .08s ease,box-shadow .2s ease,background .2s ease,opacity .2s ease;outline:2px solid transparent;outline-offset:2px}
.opt:disabled{opacity:.45;box-shadow:none;cursor:not-allowed}
.opt:hover{transform:translateY(-1px)}
.opt:active{transform:translateY(0)}
.opt:focus-visible{outline:2px dashed var(--c-accent)}
.opt .label{display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;text-overflow:ellipsis;max-width:100%}
.opt.correct.flash{background:#073269;color:#04FFB4;border-color:#04FFB4}
.opt.wrong.flash{background:#3b0c20;color:#F9577E;border-color:#F9577E}
.info{background:#C5FFDF;color:#0B214A;border:1px solid var(--c-accent);border-radius:12px;padding:8px 10px;font-size:13px}
.fade-in{animation:fadeIn .28s ease}
.fade-out{animation:fadeOut .2s ease}
@keyframes fadeIn{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:translateY(0)}}
@keyframes fadeOut{from{opacity:1}to{opacity:0}}
.slide-next{animation:slideNext .28s ease}
@keyframes slideNext{from{opacity:.2;transform:translateX(12px)}to{opacity:1;transform:translateX(0)}}
.modal{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(26,27,47,.36);backdrop-filter:blur(2px);z-index:9}
.card{max-height:90svh;max-width:520px;width:min(92%,480px);background:#fff;border:1px solid var(--c-accent);border-radius:16px;box-shadow:0 16px 40px rgba(0,0,0,.18);padding:18px 16px;display:flex;flex-direction:column;gap:12px}
.card h2{margin:0;font-size:clamp(18px,4.8vw,24px)}
.card p{margin:0;font-size:14px;line-height:1.25}
.card .cta{margin-top:4px}
.cta{height:52px;border-radius:24px;border:1px solid var(--c-accent);background:var(--c-btn);color:var(--c-accent);font-weight:700;box-shadow:0 8px 18px rgba(11,33,74,.25);font-size:clamp(14px,4vw,18px)}
.results{position:fixed;inset:0;padding:calc(env(safe-area-inset-top) + 16px) 16px calc(env(safe-area-inset-bottom) + 24px);overflow-y:auto;background:#fff;z-index:8;display:none}
.results.show{display:block}
.summaryHead{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px}
.summaryHead h3{margin:0;font-size:clamp(18px,4.6vw,24px)}
.list{display:flex;flex-direction:column;gap:12px}
.item{border:1px solid var(--c-accent);border-radius:12px;padding:10px}
.qline{display:flex;align-items:center;gap:8px}
.dot{width:12px;height:12px;border-radius:50%}
.ok{background:var(--c-ok)}
.bad{background:var(--c-err)}
.qtxt{font-weight:600;font-size:15px;flex:1;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}
.ans{margin-top:6px;font-size:14px}
.ans .you{color:#0B214A}
.ans .good{color:#04FFB4}
.expl{margin-top:4px;font-size:13px;color:#1A1B2F}
.tip{margin:10px 0;background:#C5FFDF;border:1px solid var(--c-accent);border-radius:12px;padding:10px;color:#0B214A}
.end{position:sticky;bottom:8px;margin-top:12px}
.hidden{display:none}
.compact .title{font-size:clamp(16px,4vw,20px)}
.compact .question{font-size:clamp(15px,3.8vw,18px)}
.compact .opt{height:52px;min-height:52px}
.compact .hud{gap:4px}
</style></head><body>
<div class="scene" id="scene">
  <img class="avatar" src="https://techkampe.github.io/daily-streak/assets/Avatar%203_low.png" alt="Avatar guía" loading="eager">
  <div class="uiRoot" id="uiRoot">
    <div class="hud">
      <span class="badge">PRL BT</span>
      <div class="progressWrap">
        <div class="progressText" id="progText" aria-live="polite">1/5</div>
        <div class="pbar"><div class="pfill" id="pfill"></div></div>
      </div>
      <h1 class="title">¡No te chispotees! ⚡️</h1>
    </div>
    <div class="content" id="content" role="group" aria-label="Quiz de seguridad eléctrica">
      <div class="info" id="hint">Toca la opción correcta. Avanza solo; 5 turnos.</div>
      <div class="question fade-in" id="qText">...</div>
      <div class="options" id="opts">
        <button class="opt" id="o0" data-idx="0" aria-label=""><span class="label"></span></button>
        <button class="opt" id="o1" data-idx="1" aria-label=""><span class="label"></span></button>
        <button class="opt" id="o2" data-idx="2" aria-label=""><span class="label"></span></button>
      </div>
    </div>
  </div>
  <div class="safe-spot" aria-hidden="true"></div>
  <div class="modal" id="intro">
    <div class="card" role="dialog" aria-modal="true" aria-labelledby="introT">
      <h2 id="introT">¡No te chispotees! ⚡️</h2>
      <p>Eres aprendiz de electricista. Responde 5 situaciones clave de PRL en baja tensión. Toca una opción por turno: sin scroll y con avance automático.</p>
      <button class="cta" id="startBtn" aria-label="Empezar el reto">Empezar</button>
    </div>
  </div>
</div>

<div class="results" id="results" aria-live="polite">
  <div class="summaryHead">
    <h3>Resultados del reto</h3>
    <div class="badge" id="scoreBadge">0/5</div>
  </div>
  <div class="list" id="list"></div>
  <div class="tip" id="tip">Consejo: Aplica siempre las 5 Reglas de Oro y usa EPI adecuados; la prisa es el peor enemigo de la seguridad.</div>
  <div class="end"><button class="cta" style="width:100%" onclick="completeTask()">Ver mi recompensa</button></div>
</div>

<script>
function clampTxt(t,max=48){if(!t)return"";return t.length>max?t.slice(0,max-1)+"…":t}
const QUESTIONS=[{q:"Antes de intervenir en un cuadro, ¿primero...?",a:["Cortar la alimentación y enclavar el seccionador","Poner guantes y tocar fase con tester","Avisar y seguir si no hay chispa visible"],c:0,e:"Seccionar y enclavar elimina energización accidental. Es el primer paso seguro."},{q:"Tras seccionar, ¿qué paso de las 5 Reglas sigue?",a:["Verificar ausencia de tensión","Colocar señal de salida","Encender iluminación del cuadro"],c:0,e:"Verifica ausencia de tensión con equipo adecuado antes de tocar conductores."},{q:"EPI obligado para baja tensión en obra:",a:["Guantes dieléctricos y calzado aislante","Guantes de cuero y chanclas","Solo casco si hay supervisión"],c:0,e:"EPI dieléctrico reduce el riesgo de contacto indirecto y arcos."},{q:"Ves un cable pelado en zona de paso, haces:",a:["Delimitar y señalizar el área de riesgo","Ignorar si nadie lo pisa","Patearlo al borde"],c:0,e:"Delimitar, señalizar y comunicar evita contactos y caídas. Luego corrige el defecto."},{q:"Bloqueo/etiquetado (LOTO) sirve para:",a:["Evitar reenergizar mientras trabajas","Guardar EPIs del equipo","Acelerar el arranque"],c:0,e:"LOTO impide la reconexión inesperada. Protege a quien interviene."}];
let i=0,answers=[],locked=false;
const scene=document.getElementById("scene"),uiRoot=document.getElementById("uiRoot"),qText=document.getElementById("qText"),optsBox=document.getElementById("opts"),pfill=document.getElementById("pfill"),progText=document.getElementById("progText"),intro=document.getElementById("intro"),results=document.getElementById("results"),list=document.getElementById("list"),hint=document.getElementById("hint"),scoreBadge=document.getElementById("scoreBadge");
function render(){const Q=QUESTIONS[i];progText.textContent=(i+1)+"/"+QUESTIONS.length;pfill.style.width=((i)/QUESTIONS.length*100)+"%";qText.textContent=Q.q;qText.classList.remove("fade-in");setTimeout(()=>qText.classList.add("fade-in"),0);const btns=[...optsBox.querySelectorAll(".opt")];btns.forEach((b,idx)=>{const L=b.querySelector(".label");const text=clampTxt(Q.a[idx]);L.textContent=text;b.setAttribute("aria-label",text);b.disabled=false;b.classList.remove("flash","correct","wrong")});ensureFits()}
function next(){if(i<QUESTIONS.length-1){i++;render();animateNext()}else finish()}
function animateNext(){qText.classList.add("slide-next");optsBox.classList.add("slide-next");setTimeout(()=>{qText.classList.remove("slide-next");optsBox.classList.remove("slide-next")},320)}
optsBox.addEventListener("click",ev=>{const btn=ev.target.closest(".opt");if(!btn||locked)return;locked=true;const pick=+btn.dataset.idx;const Q=QUESTIONS[i];const correct=Q.c===pick;answers[i]={pick,correct};[...optsBox.children].forEach(b=>b.disabled=true);btn.classList.add("flash",correct?"correct":"wrong");setTimeout(()=>{locked=false;next()},550)});
function finish(){pfill.style.width="100%";showResults()}
function showResults(){buildSummary();document.documentElement.classList.add("results-mode");document.body.classList.add("results-mode");results.classList.add("show");}
function buildSummary(){list.innerHTML="";let score=0;QUESTIONS.forEach((Q,idx)=>{const item=document.createElement("div");item.className="item";const ok=answers[idx]?.correct;score+=ok?1:0;const youIdx=answers[idx]?.pick;const you=youIdx!=null?Q.a[youIdx]:"Sin respuesta";const good=Q.a[Q.c];item.innerHTML=`<div class="qline"><span class="dot ${ok?"ok":"bad"}"></span><div class="qtxt">${Q.q}</div></div><div class="ans"><span class="you">Tu respuesta:</span> ${clampTxt(you,60)}</div><div class="ans"><span class="good">Correcta:</span> ${clampTxt(good,60)}</div><div class="expl">${Q.e}</div>`;list.appendChild(item)});scoreBadge.textContent=`${score}/${QUESTIONS.length}`}
document.getElementById("startBtn").addEventListener("click",()=>{intro.style.display="none";hint.style.display="none";render()});
function assertNoOverflow(){return scene.scrollHeight<=scene.clientHeight}
function applyCompactMode(){if(!scene.classList.contains("compact"))scene.classList.add("compact")}
function fitBoardToViewport(){document.documentElement.style.setProperty("--gap","12px")}
function autoscaleUI(){let scale=1;for(let s=1;s>=0.88;s-=0.02){uiRoot.style.setProperty("--ui-scale",s);scene.style.setProperty("--ui-scale",s);document.documentElement.style.setProperty("--ui-scale",s);uiRoot.style.transform=`scale(${s})`;uiRoot.style.width=`calc(100%/${s})`;uiRoot.style.height=`calc(100%/${s})`;if(assertNoOverflow()){scale=s;break}}return scale}
function ensureFits(){if(assertNoOverflow())return;applyCompactMode();if(assertNoOverflow())return;fitBoardToViewport();if(assertNoOverflow())return;autoscaleUI()}
window.addEventListener("resize",ensureFits);window.addEventListener("orientationchange",()=>setTimeout(ensureFits,200));
render();
function completeTask(){if(window.ReactNativeWebView){window.ReactNativeWebView.postMessage(JSON.stringify({action:"TASK_COMPLETED"}))}}
</script>
</body></html>