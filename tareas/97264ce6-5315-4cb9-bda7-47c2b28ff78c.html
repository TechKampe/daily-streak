
<!DOCTYPE html>
<html lang="es" class="gameplay">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<title>Tu primera entrevista de trabajo ğŸ¯ - KÃ¤mpe Games</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@500;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://techkampe.github.io/daily-streak/assets/css/daily_tasks.css">
</head>
<body>
<div class="scene gameplay" id="scene"></div>
<img class="avatar" src="https://techkampe.github.io/daily-streak/assets/Avatar%203_low.png" alt="" loading="lazy">
<script>
const avatars={
laura:{name:"Laura (RRHH)",img:"https://techkampe.github.io/daily-streak/assets/Avatar%203_low.png"},
carlos:{name:"Carlos (TÃ©cnico)",img:"https://techkampe.github.io/daily-streak/assets/Avatar%201_low.png"}
};

const turns=[
{
messages:[
{from:"laura",text:"Â¡Hola! Soy Laura, de RRHH. Gracias por conectarte. Â¿CÃ³mo estÃ¡s?"}
],
options:[
{text:"Â¡Hola Laura! Muy bien, gracias. Encantado de conocerte.",score:2,reaction:"ğŸ˜Š Â¡QuÃ© buena energÃ­a! Me alegra."},
{text:"Bien... un poco nervioso, la verdad.",score:1,reaction:"Tranquilo, es normal. RelÃ¡jate."},
{text:"Pues aquÃ­, tirando. Â¿Empezamos ya?",score:0,reaction:"Hmm, vale... vamos al tema entonces."}
]
},
{
messages:[
{from:"laura",text:"CuÃ©ntame, Â¿por quÃ© quieres trabajar como ayudante de electricista?"}
],
options:[
{text:"Me apasiona la electricidad y quiero aprender de profesionales.",score:2,reaction:"Â¡Excelente! Esa motivaciÃ³n se nota."},
{text:"Necesito trabajo y vi la oferta publicada.",score:0,reaction:"Entiendo... pero buscamos algo mÃ¡s de interÃ©s."},
{text:"Creo que podrÃ­a estar bien, aunque no sÃ© mucho.",score:1,reaction:"Hmm, la actitud importa, pero necesitamos compromiso."}
]
},
{
messages:[
{from:"laura",text:"Te presento a Carlos, nuestro tÃ©cnico senior. Tiene una pregunta."},
{from:"carlos",text:"Â¿QuÃ© harÃ­as si encuentras un cable pelado en una instalaciÃ³n?"}
],
options:[
{text:"Cortar la corriente, seÃ±alizar y avisar al responsable.",score:2,reaction:"ğŸ‘ Perfecto. Seguridad ante todo."},
{text:"IntentarÃ­a arreglarlo yo mismo rÃ¡pidamente.",score:0,reaction:"âš ï¸ Eso es peligroso sin supervisiÃ³n."},
{text:"PreguntarÃ­a quÃ© hacer, no quiero equivocarme.",score:1,reaction:"Bien preguntar, pero debes saber lo bÃ¡sico."}
]
},
{
messages:[
{from:"laura",text:"Â¿CuÃ¡l dirÃ­as que es tu mayor debilidad?"}
],
options:[
{text:"A veces soy perfeccionista, pero trabajo en equilibrarlo.",score:2,reaction:"Buena autoconciencia. Eso es madurez."},
{text:"Ninguna, soy muy buen trabajador.",score:0,reaction:"Hmm, todos tenemos Ã¡reas de mejora..."},
{text:"No sÃ©... Â¿llegar tarde a veces?",score:0,reaction:"Eso es preocupante para nosotros."}
]
},
{
messages:[
{from:"laura",text:"Â¿Tienes disponibilidad para empezar pronto y hacer formaciÃ³n inicial?"}
],
options:[
{text:"SÃ­, estoy disponible y muy motivado para aprender.",score:2,reaction:"Â¡Perfecto! Eso nos encanta escuchar."},
{text:"Depende del horario, tendrÃ­a que ver.",score:1,reaction:"Ok, lo hablamos si avanzas en el proceso."},
{text:"Supongo que sÃ­, no tengo mucho mÃ¡s que hacer.",score:0,reaction:"Buscamos entusiasmo, no solo disponibilidad."}
]
}
];

let currentTurn=0,chatHistory=[],decisions=[];
const scene=document.getElementById('scene');

function renderIntro(){
scene.innerHTML=`
<div class="hud">
<div class="hud-titles">
<div class="brand">Tu primera entrevista ğŸ¯</div>
<div class="subtitle">Videollamada con Laura (RRHH)</div>
</div>
</div>
<div class="main" style="display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center;padding:24px;">
<img src="${avatars.laura.img}" alt="Laura" style="width:80px;height:80px;border-radius:50%;margin-bottom:16px;">
<div style="font-size:1.1rem;margin-bottom:8px;">Â¡Conseguiste tu primera entrevista!</div>
<div style="font-size:0.95rem;opacity:0.85;">Puesto: Ayudante de electricista</div>
</div>
<div class="footer">
<div class="helper">Responde de forma profesional</div>
<button class="cta" onclick="startChat()">Conectar videollamada</button>
</div>`;
ensureFits();
}

function startChat(){
currentTurn=0;
chatHistory=[];
decisions=[];
renderTurn();
}

function renderTurn(){
if(currentTurn>=turns.length){showResults();return;}
const turn=turns[currentTurn];
turn.messages.forEach(m=>{
chatHistory.push({from:m.from,text:m.text,isUser:false});
});
renderChatScreen();
}

function renderChatScreen(){
const turn=turns[currentTurn];
scene.innerHTML=`
<div class="hud">
<div class="hud-titles">
<div class="brand">Tu primera entrevista ğŸ¯</div>
<div class="subtitle">En videollamada</div>
</div>
<div class="progress-row">
<div class="bar-wrap"><div class="bar"><i style="width:${((currentTurn+1)/turns.length)*100}%"></i></div></div>
<span class="badge">${currentTurn+1}/${turns.length}</span>
</div>
</div>
<div class="chat-container" id="chatContainer">
${chatHistory.map(m=>`
<div class="chat-bubble ${m.isUser?'user':'npc'}">
${!m.isUser?`<img src="${avatars[m.from].img}" class="chat-avatar" alt="">`:''}
<div class="chat-content">
${!m.isUser?`<div class="chat-name">${avatars[m.from].name}</div>`:''}
<div class="chat-text">${m.text}</div>
</div>
</div>
`).join('')}
</div>
<div class="footer">
<div class="options" id="optionsArea">
${turn.options.map((o,i)=>`<button class="btn-option" onclick="selectOption(${i})">${o.text}</button>`).join('')}
</div>
</div>`;
const container=document.getElementById('chatContainer');
container.scrollTop=container.scrollHeight;
ensureFits();
}

function selectOption(idx){
const turn=turns[currentTurn];
const opt=turn.options[idx];
chatHistory.push({from:'user',text:opt.text,isUser:true});
decisions.push({question:turn.messages[turn.messages.length-1].text,answer:opt.text,score:opt.score,reaction:opt.reaction});
const reactor=turn.messages.length>1&&turn.messages[1].from==='carlos'?'carlos':'laura';
chatHistory.push({from:reactor,text:opt.reaction,isUser:false});
currentTurn++;
setTimeout(()=>{renderTurn();},300);
}

function showResults(){
setTimeout(()=>{
document.documentElement.classList.replace('gameplay','results');
scene.classList.replace('gameplay','results');
const total=decisions.reduce((a,d)=>a+d.score,0);
const max=decisions.length*2;
const pct=Math.round((total/max)*100);
let grade=pct>=80?'Â¡Excelente impresiÃ³n!':pct>=50?'Buena entrevista':'Puedes mejorar';
scene.innerHTML=`
<div class="results-header">
<div class="results-title">${grade}</div>
<div class="results-score">${total}/${max}</div>
<div class="results-subtitle">Puntos de comunicaciÃ³n</div>
</div>
<div class="results-list">
${decisions.map((d,i)=>`
<div class="result-item ${d.score===2?'correct':d.score===1?'':'incorrect'}">
<div class="result-question">${i+1}. ${d.question.substring(0,50)}...</div>
<div class="result-answer">${d.score===2?'âœ“ Profesional':d.score===1?'â— Aceptable':'âœ— Mejorable'}</div>
<div class="result-explanation">${getExplanation(i,d.score)}</div>
</div>`).join('')}
<div class="result-item">
<div class="result-question">ğŸ’¡ Consejo prÃ¡ctico</div>
<div class="result-explanation">Prepara respuestas a preguntas tÃ­picas, mantÃ©n contacto visual y muestra entusiasmo genuino por aprender el oficio.</div>
</div>
</div>
<div class="footer" style="position:sticky;bottom:0;background:var(--bg);padding:16px;">
<button class="cta" onclick="completeTask()">Ver mi recompensa</button>
</div>`;
},500);
}

function getExplanation(idx,score){
const explanations=[
["Un saludo cordial transmite profesionalidad y buena actitud.","Mostrar nervios es humano, pero intenta proyectar confianza.","Ser brusco puede dar mala primera impresiÃ³n."],
["Mostrar pasiÃ³n por el oficio es clave para destacar.","Solo mencionar necesidad econÃ³mica no te diferencia.","La inseguridad puede generar dudas sobre tu compromiso."],
["Priorizar seguridad demuestra conocimiento bÃ¡sico esencial.","Actuar sin supervisiÃ³n en situaciones de riesgo es peligroso.","Preguntar estÃ¡ bien, pero debes conocer protocolos bÃ¡sicos."],
["Reconocer debilidades con plan de mejora muestra madurez.","Decir que no tienes debilidades parece poco sincero.","Admitir impuntualidad es una bandera roja para empleadores."],
["Disponibilidad y motivaciÃ³n juntas son la combinaciÃ³n ganadora.","Poner condiciones en la primera entrevista puede restar puntos.","La falta de entusiasmo se percibe negativamente."]
];
return explanations[idx][score===2?0:score===1?1:2];
}

function completeTask(){
if(window.ReactNativeWebView){
window.ReactNativeWebView.postMessage(JSON.stringify({action:'TASK_COMPLETED'}));
}
}

function ensureFits(){
scene.classList.remove('compact','compact-xs');
document.documentElement.style.setProperty('--ui-scale',1);
if(scene.scrollHeight>scene.clientHeight)scene.classList.add('compact');
if(scene.scrollHeight>scene.clientHeight)scene.classList.add('compact-xs');
if(scene.scrollHeight>scene.clientHeight){
document.documentElement.style.setProperty('--ui-scale',Math.max(0.88,scene.clientHeight/scene.scrollHeight));
}
}

window.addEventListener('load',()=>{ensureFits();renderIntro();});
window.addEventListener('resize',ensureFits);
window.addEventListener('orientationchange',()=>setTimeout(ensureFits,100));

const style=document.createElement('style');
style.textContent=`
.chat-container{flex:1;overflow-y:auto;padding:12px;display:flex;flex-direction:column;gap:10px;-webkit-overflow-scrolling:touch;}
.chat-bubble{display:flex;gap:8px;max-width:85%;}
.chat-bubble.npc{align-self:flex-start;}
.chat-bubble.user{align-self:flex-end;flex-direction:row-reverse;}
.chat-avatar{width:36px;height:36px;border-radius:50%;flex-shrink:0;}
.chat-content{background:var(--card);border-radius:12px;padding:8px 12px;}
.chat-bubble.user .chat-content{background:var(--bg);color:#000;border:1px solid var(--border);}
.chat-name{font-size:0.75rem;font-weight:700;opacity:0.7;margin-bottom:2px;}
.chat-text{font-size:0.9rem;line-height:1.3;}
#optionsArea{display:flex;flex-direction:column;gap:8px;width:100%;}
#optionsArea .btn-option{font-size:0.85rem;padding:10px 12px;text-align:left;white-space:normal;line-height:1.2;}
`;
document.head.appendChild(style);
</script>
</body>
</html>
