
<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<title>Cada Cosa en su Momento: FontanerÃ­a ðŸ’§ | KÃ¤mpe</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@400;600;700&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box}
html,body{width:100%;height:100%;overflow:hidden;overscroll-behavior:none;font-family:'Baloo 2',sans-serif;background:#F5F5F0;color:#1A1B2F}
.scene{width:100%;position:relative;display:flex;flex-direction:column;touch-action:none}
@supports(height:100svh){.scene{height:100svh}}
@supports not(height:100svh){.scene{height:100dvh}}
@supports not(height:100dvh){.scene{height:100vh}}
.scene.results-mode{overflow-y:auto;touch-action:auto}
.modal{position:fixed;inset:0;background:rgba(26,27,47,0.85);display:flex;align-items:center;justify-content:center;z-index:999;padding:env(safe-area-inset-top,20px) env(safe-area-inset-right,20px) env(safe-area-inset-bottom,20px) env(safe-area-inset-left,20px)}
.modal-content{background:#FFF;border-radius:24px;padding:clamp(20px,5vw,32px);max-width:min(420px,90vw);max-height:90svh;overflow-y:auto;box-shadow:0 12px 40px rgba(0,0,0,0.2);position:relative}
.logo{width:clamp(80px,20vw,120px);height:auto;margin:0 auto 16px}
h1{font-size:clamp(20px,5.5vw,28px);font-weight:700;color:#1A1B2F;margin-bottom:12px;line-height:1.2;text-align:center}
.subtitle{font-size:clamp(13px,3.5vw,15px);color:#555;margin-bottom:20px;line-height:1.4;display:-webkit-box;-webkit-line-clamp:6;-webkit-box-orient:vertical;overflow:hidden}
.btn{background:linear-gradient(135deg,#1EA4FF,#007BFF);color:#FFF;border:none;border-radius:16px;padding:14px 24px;font-size:clamp(15px,4vw,17px);font-weight:600;font-family:'Baloo 2',sans-serif;cursor:pointer;min-height:48px;display:flex;align-items:center;justify-content:center;transition:transform 0.2s,box-shadow 0.2s;box-shadow:0 4px 12px rgba(30,164,255,0.3)}
.btn:active{transform:scale(0.96);box-shadow:0 2px 8px rgba(30,164,255,0.4)}
.game-container{flex:1;display:flex;flex-direction:column;padding:env(safe-area-inset-top,12px) env(safe-area-inset-right,16px) env(safe-area-inset-bottom,12px) env(safe-area-inset-left,16px);overflow:hidden}
.hud{display:flex;justify-content:space-between;align-items:center;margin-bottom:clamp(12px,3vh,20px);flex-shrink:0}
.hud-logo{width:clamp(60px,15vw,80px);height:auto}
.progress{font-size:clamp(14px,3.5vw,16px);font-weight:600;color:#1A1B2F;background:#FFF;padding:8px 16px;border-radius:20px;box-shadow:0 2px 8px rgba(0,0,0,0.08)}
.item-card{background:#FFF;border-radius:20px;padding:clamp(20px,5vw,32px);margin-bottom:clamp(16px,4vh,24px);box-shadow:0 6px 20px rgba(0,0,0,0.1);text-align:center;flex-shrink:0}
.item-text{font-size:clamp(16px,4.5vw,20px);font-weight:600;color:#1A1B2F;line-height:1.3;display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden}
.categories{display:flex;flex-direction:column;gap:clamp(10px,2.5vh,14px);flex-shrink:0}
.cat-btn{background:linear-gradient(135deg,#E8F4FD,#D0EBFF);color:#007BFF;border:3px solid transparent;border-radius:16px;padding:clamp(12px,3vh,16px);font-size:clamp(14px,3.5vw,16px);font-weight:600;font-family:'Baloo 2',sans-serif;cursor:pointer;min-height:52px;transition:all 0.3s;box-shadow:0 3px 10px rgba(0,0,0,0.08);display:flex;align-items:center;justify-content:center;text-align:center;line-height:1.2}
.cat-btn:active{transform:scale(0.94);border-color:#1EA4FF}
.cat-btn.selected{animation:dropIn 0.4s cubic-bezier(0.34,1.56,0.64,1)}
@keyframes dropIn{0%{transform:scale(1.1) translateY(-10px);border-color:#1EA4FF;box-shadow:0 8px 20px rgba(30,164,255,0.4)}50%{transform:scale(1.05)}100%{transform:scale(1);border-color:#1EA4FF}}
.avatar-bg{position:fixed;bottom:-40px;right:-40px;width:clamp(180px,45vw,280px);height:auto;opacity:0.15;z-index:0;pointer-events:none}
.results-container{padding:env(safe-area-inset-top,20px) env(safe-area-inset-right,20px) env(safe-area-inset-bottom,20px) env(safe-area-inset-left,20px);max-width:600px;margin:0 auto}
.score-box{background:linear-gradient(135deg,#1EA4FF,#007BFF);color:#FFF;border-radius:20px;padding:clamp(24px,6vw,32px);text-align:center;margin-bottom:24px;box-shadow:0 8px 24px rgba(30,164,255,0.3)}
.score-box h2{font-size:clamp(22px,6vw,32px);margin-bottom:8px}
.score-box p{font-size:clamp(14px,3.5vw,16px);opacity:0.95}
.item-review{background:#FFF;border-radius:16px;padding:16px;margin-bottom:16px;box-shadow:0 4px 12px rgba(0,0,0,0.08)}
.item-review h3{font-size:clamp(15px,4vw,17px);color:#1A1B2F;margin-bottom:8px;display:flex;align-items:center;gap:8px}
.item-review p{font-size:clamp(13px,3.5vw,14px);color:#555;line-height:1.4;margin-bottom:4px}
.badge{display:inline-block;padding:4px 12px;border-radius:12px;font-size:12px;font-weight:600;margin-left:8px}
.badge.correct{background:#D4EDDA;color:#155724}
.badge.wrong{background:#F8D7DA;color:#721C24}
.advice-box{background:#FFF9E6;border-left:4px solid #FFC107;padding:16px;border-radius:12px;margin:24px 0;font-size:clamp(13px,3.5vw,15px);color:#1A1B2F;line-height:1.5}
.final-btn{margin-top:24px;width:100%}
.compact .hud{margin-bottom:8px}
.compact .item-card{padding:16px;margin-bottom:12px}
.compact .item-text{font-size:clamp(14px,4vw,18px)}
.compact .categories{gap:8px}
.compact .cat-btn{padding:10px;min-height:48px;font-size:clamp(13px,3.2vw,15px)}
.hidden{display:none!important}
</style>
</head>
<body>
<div class="scene" id="scene">
<div class="modal" id="introModal">
<div class="modal-content">
<img src="https://techkampe.github.io/daily-streak/assets/kampe_logo_oscuro.png" alt="KÃ¤mpe" class="logo" loading="eager">
<h1>Cada Cosa en su Momento: FontanerÃ­a ðŸ’§</h1>
<p class="subtitle">Acudes a un aviso como tÃ©cnico/a de fontanerÃ­a. En cada visita, no solo arreglas la averÃ­a, sino que tambiÃ©n gestionas tu seguridad y la relaciÃ³n con el cliente. Clasifica cada acciÃ³n en su categorÃ­a: <strong>Tarea TÃ©cnica</strong>, <strong>Seguridad y PRL</strong> o <strong>AtenciÃ³n al Cliente</strong>.</p>
<button class="btn" onclick="startGame()">Â¡Comenzar el Reto!</button>
</div>
</div>
<div class="game-container hidden" id="gameContainer">
<div class="hud">
<img src="https://techkampe.github.io/daily-streak/assets/kampe_logo_oscuro.png" alt="KÃ¤mpe" class="hud-logo" loading="lazy">
<div class="progress" id="progress">1/10</div>
</div>
<div class="item-card">
<div class="item-text" id="itemText">Cerrar la llave de paso</div>
</div>
<div class="categories" id="categories">
<button class="cat-btn" data-cat="0">ðŸ”§ Tarea TÃ©cnica</button>
<button class="cat-btn" data-cat="1">ðŸ¦º Seguridad y PRL</button>
<button class="cat-btn" data-cat="2">ðŸ’¬ AtenciÃ³n al Cliente</button>
</div>
</div>
<div class="results-container hidden" id="resultsContainer"></div>
<img src="https://techkampe.github.io/daily-streak/assets/Avatar%202_low.png" alt="" class="avatar-bg" loading="lazy">
</div>
<script>
const items=[
{text:"Cerrar la llave de paso",correct:0,explanation:"AcciÃ³n tÃ©cnica bÃ¡sica para controlar el flujo de agua antes de intervenir."},
{text:"Explicar la factura al cliente",correct:2,explanation:"Parte esencial de la atenciÃ³n al cliente: transparencia y profesionalidad."},
{text:"Utilizar guantes de protecciÃ³n",correct:1,explanation:"Medida de prevenciÃ³n de riesgos laborales para evitar cortes o contacto con productos quÃ­micos."},
{text:"Reemplazar el cartucho del grifo",correct:0,explanation:"Tarea tÃ©cnica: reparaciÃ³n directa del elemento averiado."},
{text:"Comprobar que el Ã¡rea estÃ© ventilada",correct:1,explanation:"Seguridad y PRL: evitar acumulaciÃ³n de gases o humedad peligrosa."},
{text:"Llamar al cliente antes de la visita",correct:2,explanation:"Buena prÃ¡ctica de atenciÃ³n: confirmar disponibilidad y demostrar profesionalidad."},
{text:"Desmontar el sifÃ³n del lavabo",correct:0,explanation:"AcciÃ³n tÃ©cnica para acceder a posibles atascos o fugas."},
{text:"Usar gafas de seguridad al soldar",correct:1,explanation:"Equipo de protecciÃ³n individual obligatorio para evitar lesiones oculares."},
{text:"Informar al cliente sobre el tiempo estimado",correct:2,explanation:"ComunicaciÃ³n clave para gestionar expectativas y mantener la confianza."},
{text:"Aplicar teflÃ³n a la rosca de un tubo",correct:0,explanation:"TÃ©cnica profesional para garantizar estanqueidad en las uniones."}
];
let currentIndex=0;
let userAnswers=[];
let initData="";
function getInitData(){
const params=new URLSearchParams(window.location.search);
initData=params.get('initData')||"";
}
function startGame(){
document.getElementById('introModal').classList.add('hidden');
document.getElementById('gameContainer').classList.remove('hidden');
renderItem();
requestAnimationFrame(()=>{
ensureFits();
});
}
function renderItem(){
if(currentIndex>=items.length){
showResults();
return;
}
document.getElementById('itemText').textContent=items[currentIndex].text;
document.getElementById('progress').textContent=`${currentIndex+1}/${items.length}`;
document.querySelectorAll('.cat-btn').forEach(btn=>{
btn.classList.remove('selected');
btn.disabled=false;
});
}
function selectCategory(catIndex){
userAnswers.push(catIndex);
const btns=document.querySelectorAll('.cat-btn');
btns.forEach(btn=>btn.disabled=true);
btns[catIndex].classList.add('selected');
setTimeout(()=>{
currentIndex++;
renderItem();
},600);
}
function showResults(){
document.getElementById('gameContainer').classList.add('hidden');
const scene=document.getElementById('scene');
scene.classList.add('results-mode');
const container=document.getElementById('resultsContainer');
container.classList.remove('hidden');
let correct=0;
userAnswers.forEach((ans,i)=>{
if(ans===items[i].correct)correct++;
});
const catNames=["ðŸ”§ Tarea TÃ©cnica","ðŸ¦º Seguridad y PRL","ðŸ’¬ AtenciÃ³n al Cliente"];
let html=`
<div class="score-box">
<h2>Â¡Reto Completado!</h2>
<p>Has acertado <strong>${correct} de ${items.length}</strong> clasificaciones</p>
</div>
`;
items.forEach((item,i)=>{
const isCorrect=userAnswers[i]===item.correct;
html+=`
<div class="item-review">
<h3>
${item.text}
<span class="badge ${isCorrect?'correct':'wrong'}">${isCorrect?'âœ“ Correcto':'âœ— Incorrecto'}</span>
</h3>
<p><strong>Tu respuesta:</strong> ${catNames[userAnswers[i]]}</p>
<p><strong>CategorÃ­a correcta:</strong> ${catNames[item.correct]}</p>
<p style="margin-top:8px;color:#1A1B2F;"><em>${item.explanation}</em></p>
</div>
`;
});
html+=`
<div class="advice-box">
<strong>ðŸ’¡ Consejo profesional:</strong> En cada intervenciÃ³n, entrena tu mente para identificar automÃ¡ticamente tres dimensiones: Â¿QuÃ© hago tÃ©cnicamente? Â¿Estoy protegido? Â¿He comunicado bien? Esta triple mirada te hace mÃ¡s completo y confiable.
</div>
<button class="btn final-btn" onclick="goToReward()">Ver mi recompensa</button>
`;
container.innerHTML=html;
}
function goToReward(){
const url=`https://kampe-game-phaser.onrender.com/daily_streak?initData=${encodeURIComponent(initData)}`;
window.location.href=url;
}
function ensureFits(){
const scene=document.getElementById('scene');
const game=document.getElementById('gameContainer');
if(game.classList.contains('hidden'))return;
if(game.scrollHeight>game.clientHeight+5){
scene.classList.add('compact');
}
requestAnimationFrame(()=>{
if(game.scrollHeight>game.clientHeight+5){
const scale=Math.max(0.88,game.clientHeight/game.scrollHeight);
game.style.transform=`scale(${scale})`;
game.style.transformOrigin='top center';
}
});
}
document.getElementById('categories').addEventListener('click',e=>{
if(e.target.classList.contains('cat-btn')&&!e.target.disabled){
const cat=parseInt(e.target.dataset.cat);
selectCategory(cat);
}
});
window.addEventListener('resize',()=>{
if(!document.getElementById('gameContainer').classList.contains('hidden')){
ensureFits();
}
});
window.addEventListener('orientationchange',()=>{
setTimeout(()=>{
if(!document.getElementById('gameContainer').classList.contains('hidden')){
ensureFits();
}
},300);
});
getInitData();
</script>
</body>
</html>

