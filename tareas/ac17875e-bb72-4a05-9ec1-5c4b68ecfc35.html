<!DOCTYPE html><html lang="es"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover,maximum-scale=1,user-scalable=no"/><title>¬°Ojo de Halc√≥n en la Obra! ü¶Ö</title><link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@400;600;700&display=swap" rel="stylesheet"/><style>
:root{--txt:#1A1B2F;--cta:#0B214A;--mint:#00E6BC;--ok:#04FFB4;--err:#F9577E;--soft:#C5FFDF;--ui-scale:1;--gap:12px;--cellH:64px;--cellAR:2.6}
*{box-sizing:border-box}
html,body{height:100%;margin:0;background:#fff;color:var(--txt);font-family:'Baloo 2',system-ui,sans-serif}
html,body{overflow:hidden;overscroll-behavior:none}
button{font-family:inherit}
#app{isolation:isolate}
.scene{position:relative;display:flex;flex-direction:column;justify-content:space-between;transform-origin:top left;transform:scale(var(--ui-scale));padding-left:calc(16px + env(safe-area-inset-left));padding-right:calc(16px + env(safe-area-inset-right));padding-bottom:calc(16px + env(safe-area-inset-bottom));touch-action:none}
@supports (height:100svh){.scene{height:100svh}}
@supports not (height:100svh){@supports (height:100dvh){.scene{height:100dvh}}}
@supports not (height:100dvh){.scene{height:100vh}}
.avatar{position:absolute;top:10px;left:10px;width:140px;opacity:.08;pointer-events:none;user-select:none;z-index:0}
.safeCorner{position:absolute;top:0;right:0;width:100px;height:100px;z-index:1;pointer-events:none}
.ui{position:relative;z-index:2;display:flex;flex-direction:column;gap:var(--gap)}
.hud{margin-top:80px}
.title{font-weight:800;color:var(--txt);font-size:clamp(18px,4.4vw,24px);letter-spacing:.2px}
.progressRow{display:flex;align-items:center;gap:8px}
.step{font-size:clamp(12px,3.5vw,14px);color:#0B214A;background:var(--soft);border-radius:12px;padding:2px 8px;border:1px solid var(--mint)}
.pbar{flex:1;height:8px;border-radius:999px;background:#E6FFF4;position:relative;overflow:hidden;border:1px solid var(--mint)}
.pfill{position:absolute;left:0;top:0;bottom:0;width:0;background:linear-gradient(90deg,var(--mint),#6CFFE3);transition:width .25s}
.prompt{margin-top:4px;font-size:clamp(16px,4.5vw,20px);line-height:1.15;font-weight:700;color:var(--txt);display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}
.options{display:grid;grid-template-columns:1fr 1fr;gap:var(--gap);align-content:end}
.option{min-height:var(--cellH);aspect-ratio:var(--cellAR);display:flex;align-items:center;justify-content:center;text-align:center;padding:10px;border:1px solid var(--mint);border-radius:20px;background:#fff;color:var(--txt);font-weight:700;font-size:clamp(14px,4vw,16px);box-shadow:0 8px 18px rgba(11,33,74,.08);cursor:pointer;transition:transform .06s,border-color .2s,box-shadow .2s,background .2s;outline:none}
.option:active{transform:translateY(1px) scale(.995)}
.option:focus-visible{box-shadow:0 0 0 3px rgba(0,230,188,.45)}
.option .label{display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}
.option.chosen.correct{border-color:var(--ok);background:#E7FFF6}
.option.chosen.wrong{border-color:var(--err);background:#FFE8EE}
.fadeIn{animation:fadeIn .28s ease}
.fadeOut{animation:fadeOut .28s ease forwards}
@keyframes fadeIn{from{opacity:.01;transform:translateY(4px)}to{opacity:1;transform:translateY(0)}}
@keyframes fadeOut{to{opacity:0;transform:translateY(-6px)}}
.overlay{position:fixed;inset:0;background:rgba(26,27,47,.52);display:flex;align-items:center;justify-content:center;z-index:10;padding:16px}
.modal{background:#fff;border:1px solid var(--mint);border-radius:16px;max-width:720px;width:100%;max-height:90svh;overflow-y:auto;padding:18px 16px;box-shadow:0 10px 30px rgba(11,33,74,.25)}
.mTitle{font-size:clamp(20px,5vw,28px);font-weight:800;margin:4px 0 8px}
.mDesc{font-size:clamp(14px,3.8vw,16px);color:#0B214A;line-height:1.25}
.mHint{margin:10px 0 12px;background:#C5FFDF;padding:10px;border-radius:12px;border:1px solid var(--mint);color:#0B214A;font-weight:700;font-size:clamp(13px,3.7vw,15px)}
.cta{display:inline-flex;align-items:center;justify-content:center;gap:8px;background:var(--cta);color:var(--mint);border:none;border-radius:24px;padding:12px 18px;font-weight:800;font-size:clamp(15px,4.2vw,18px);box-shadow:0 8px 18px rgba(11,33,74,.25);width:100%;min-height:48px}
.cta[disabled]{opacity:.4;box-shadow:none}
.modalFooter{position:sticky;bottom:0;background:#fff;padding-top:12px;margin-top:10px}
.compact .title{font-size:clamp(16px,4vw,20px)}
.compact .prompt{font-size:clamp(14px,3.8vw,18px)}
.compact .option{border-radius:16px}
#summary[aria-hidden="false"]{display:block}
#summary[aria-hidden="true"]{display:none}
.summaryWrap{max-width:800px;margin:0 auto;padding:calc(16px + env(safe-area-inset-top)) calc(16px + env(safe-area-inset-right)) calc(24px + env(safe-area-inset-bottom)) calc(16px + env(safe-area-inset-left))}
.sTitle{font-size:clamp(20px,5vw,28px);font-weight:800;margin-bottom:6px}
.sMeta{color:#0B214A;margin-bottom:10px}
.row{border:1px solid var(--mint);border-radius:14px;padding:12px;margin-bottom:12px;background:#fff}
.rowHead{font-weight:800;margin-bottom:6px}
.badge{display:inline-block;border-radius:999px;padding:2px 8px;font-size:12px;border:1px solid var(--mint);margin-right:6px}
.good{color:#0B214A;background:#E7FFF6;border-color:var(--ok)}
.bad{color:#0B214A;background:#FFE8EE;border-color:var(--err)}
.kv{display:flex;gap:8px;flex-wrap:wrap}
.kv span{background:#F7FFFC;border:1px solid var(--mint);border-radius:10px;padding:4px 8px;font-size:13px}
.explain{margin-top:8px;color:#0B214A;font-size:14px}
.tip{background:#C5FFDF;border:1px solid var(--mint);border-radius:12px;padding:12px;margin:14px 0;color:#0B214A}
.finalBar{position:sticky;bottom:0;background:#fff;padding-top:8px}
.hidden{display:none}
</style></head><body><div id="app">
  <div class="scene fadeIn" id="scene" role="region" aria-label="Reto diario">
    <img class="avatar" src="https://techkampe.github.io/daily-streak/assets/Avatar 2_low.png" alt="Avatar gu√≠a" width="140" height="140"/>
    <div class="safeCorner" aria-hidden="true"></div>
    <div class="ui">
      <div class="hud">
        <div class="title" id="title">¬°Ojo de Halc√≥n en la Obra! ü¶Ö</div>
        <div class="progressRow">
          <span class="step" id="step">1/5</span>
          <div class="pbar" aria-hidden="true"><div class="pfill" id="pfill" style="width:0%"></div></div>
        </div>
        <div class="prompt" id="prompt"></div>
      </div>
      <div class="options" id="options" role="group" aria-label="Opciones"></div>
    </div>
  </div>

  <div class="overlay" id="intro" aria-modal="true" role="dialog">
    <div class="modal" tabindex="-1">
      <div class="mTitle">¬°Ojo de Halc√≥n en la Obra! ü¶Ö</div>
      <div class="mDesc">Est√°s en tu primer d√≠a como aprendiz en una obra y tu encargado quiere comprobar tu atenci√≥n. Este reto eval√∫a tu capacidad para identificar riesgos y malas pr√°cticas en entornos de trabajo reales. Se te presentar√°n 5 micro-escenas de la jornada laboral; en cada una, ver√°s una situaci√≥n y una lista de 3-4 elementos o acciones. Tu misi√≥n es tocar el √∫nico elemento que representa un error o un peligro. Los casos incluir√°n desde EPIs mal utilizados, herramientas inadecuadas, hasta fallos en la se√±alizaci√≥n o el orden. Al final, recibir√°s un resumen detallado de cada escena, explicando el porqu√© de cada error y un consejo pr√°ctico para desarrollar tu instinto de seguridad.</div>
      <div class="mHint">Toca el √∫nico √≠tem que est√° mal en cada escena. Avanzas al instante.</div>
      <div class="modalFooter"><button class="cta" id="startBtn" aria-label="Comenzar el reto">Empezar</button></div>
    </div>
  </div>

  <div id="summary" aria-hidden="true">
    <div class="summaryWrap">
      <div class="sTitle">Resultados del reto</div>
      <div class="sMeta" id="scoreLine"></div>
      <div id="rows"></div>
      <div class="tip" id="tipBox">Consejo pr√°ctico: antes de actuar, respira y recorre con la vista EPIs, aislamientos, se√±alizaci√≥n y orden. Si algo no cuadra, detente y comunica.</div>
      <div class="finalBar"><button class="cta" onclick="completeTask()">Ver mi recompensa</button></div>
    </div>
  </div>
</div>
<script>
function completeTask(){if(window.ReactNativeWebView){window.ReactNativeWebView.postMessage(JSON.stringify({action:'TASK_COMPLETED'}))}}
const scenes=[
{t:"Cuadro el√©ctrico temporal en obra.",o:["Guantes diel√©ctricos puestos","Cable pelado sin terminal","Candado de bloqueo LOTO","Cartel: 'No energizar'"],c:1,e:"Un cable pelado sin terminal expone conductor: riesgo de choque y corto. Coloca terminal y a√≠sla."},
{t:"Instalando tuber√≠a de PPR en cocina.",o:["Cortatubos limpio y afilado","Soldar sin ventilaci√≥n","Anillos de sujeci√≥n correctos","Llave de paso cerrada"],c:1,e:"Soldar sin ventilaci√≥n acumula vapores t√≥xicos. Abre ventilaci√≥n o usa extracci√≥n y protecci√≥n respiratoria."},
{t:"Levantando tabique de ladrillo.",o:["Mortero a la proporci√≥n indicada","Andamio con barandilla","Nivel de burbuja calibrado","Casco sin barbiquejo"],c:3,e:"El casco sin barbiquejo puede salir despedido en altura o con viento. Ajusta y abrocha siempre."},
{t:"Montaje de unidad exterior en azotea.",o:["Arn√©s anclado a l√≠nea de vida","Torniller√≠a mixta sin par","Bandeja porta-cables nivelada","Desag√ºe con sif√≥n"],c:1,e:"Mezclar torniller√≠a y no aplicar par puede aflojar la unidad. Usa tornillos especificados y torque seg√∫n ficha."},
{t:"Zona de pintura con solventes.",o:["Mascarilla con filtro A2","Cinta de peligro alrededor","Chispas de amoladora cerca","Extintor a mano"],c:2,e:"Chispas cerca de solventes pueden inflamar vapores. A√≠sla trabajos en caliente y retira fuentes de ignici√≥n."}
];
let idx=0,log=[];
const elScene=document.getElementById('scene');
const elPrompt=document.getElementById('prompt');
const elOptions=document.getElementById('options');
const elStep=document.getElementById('step');
const elFill=document.getElementById('pfill');
const intro=document.getElementById('intro');
const startBtn=document.getElementById('startBtn');
const summary=document.getElementById('summary');
const rows=document.getElementById('rows');
const scoreLine=document.getElementById('scoreLine');

function clampText(s,max){if(!s)return s;return s.length>max?s.slice(0,max-1).trim()+"‚Ä¶":s}
function render(){const s=scenes[idx];elStep.textContent=`${idx+1}/${scenes.length}`;elFill.style.width=`${((idx)/scenes.length)*100}%`;elPrompt.textContent=clampText(s.t,90);elOptions.innerHTML='';s.o.forEach((label,i)=>{const b=document.createElement('button');b.className='option';b.setAttribute('aria-label',`Opci√≥n ${i+1}`);b.innerHTML=`<span class="label">${clampText(label,48)}</span>`;b.onclick=()=>pick(i);elOptions.appendChild(b)});ensureFits()}
function pick(choice){const s=scenes[idx];const buttons=[...document.querySelectorAll('.option')];buttons.forEach((b,i)=>{if(i===choice){b.classList.add('chosen');if(i===s.c){b.classList.add('correct')}else{b.classList.add('wrong')}}});log.push({scene:idx,choice,correct:s.c});setTimeout(()=>advance(),450)}
function advance(){if(idx<scenes.length-1){idx++;transitionToScene()}else{finish()}}
function transitionToScene(){elScene.classList.remove('fadeIn');elScene.classList.add('fadeOut');setTimeout(()=>{elScene.classList.remove('fadeOut');render();elScene.classList.add('fadeIn')},220)}
function finish(){elFill.style.width='100%';setTimeout(()=>{buildSummary();unlockScroll();},500)}
function buildSummary(){summary.setAttribute('aria-hidden','false');rows.innerHTML='';let ok=0;log.forEach((r,n)=>{const s=scenes[r.scene];if(r.choice===s.c)ok++;const row=document.createElement('div');row.className='row';const good=r.choice===s.c;row.innerHTML=`<div class="rowHead">Escena ${n+1}: ${clampText(s.t,90)}</div>
<div class="kv"><span class="${good?'good':'bad'} badge">${good?'Acierto':'Error'}</span><span>Tu elecci√≥n: ${clampText(s.o[r.choice]||'-',48)}</span><span>Error: ${clampText(s.o[s.c],48)}</span></div>
<div class="explain">${clampText(s.e,180)}</div>`;rows.appendChild(row)});scoreLine.textContent=`Aciertos: ${ok}/${scenes.length}`;summary.scrollTop=0}
function unlockScroll(){document.documentElement.style.overflowY='auto';document.body.style.overflowY='auto';summary.style.display='block'}
startBtn.onclick=()=>{intro.style.display='none';render();assertNoOverflow()||ensureFits()}
function assertNoOverflow(){const c=elScene;return c.scrollHeight<=c.clientHeight}
function applyCompactMode(){elScene.classList.add('compact')}
function fitBoardToViewport(){const h=elScene.clientHeight;const hudH=document.querySelector('.hud').offsetHeight;const spare=h-hudH-36;let rows=Math.ceil(document.querySelectorAll('.option').length/2)||2;let cellH=Math.max(56,Math.min(88,Math.floor(spare/rows)-10));document.documentElement.style.setProperty('--cellH',cellH+'px');document.documentElement.style.setProperty('--cellAR',2.5)}
function autoscaleUI(){const c=elScene;let scale=1;let tries=0;while(c.scrollHeight>c.clientHeight&&scale>0.88&&tries<6){scale-=0.02;tries++}document.documentElement.style.setProperty('--ui-scale',scale.toFixed(2))}
function ensureFits(){if(assertNoOverflow())return;applyCompactMode();fitBoardToViewport();if(assertNoOverflow())return;autoscaleUI()}
window.addEventListener('resize',ensureFits,{passive:true});window.addEventListener('orientationchange',()=>setTimeout(ensureFits,200),{passive:true});
document.addEventListener('DOMContentLoaded',()=>{elPrompt.textContent='';});
</script></body></html>