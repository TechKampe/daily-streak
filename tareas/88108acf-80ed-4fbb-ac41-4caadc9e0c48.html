<!DOCTYPE html><html lang="es"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@500;700&display=swap" rel="stylesheet"><style>
:root{--blue:#0B214A;--teal:#00E6BC;--dark:#1A1B2F;--ok:#04FFB4;--err:#F9577E;--soft:#C5FFDF;--ui-scale:1;--cellH:56px;}
*{box-sizing:border-box;-webkit-tap-highlight-color:transparent}
html,body{height:100%;overflow:hidden;overscroll-behavior:none;background:#fff}
body{font-family:"Baloo 2",system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;color:var(--dark)}
.scene{position:relative;width:100%;max-width:480px;margin:0 auto;display:flex;flex-direction:column;justify-content:space-between;gap:8px;padding:calc(env(safe-area-inset-top) + 80px) 16px calc(env(safe-area-inset-bottom) + 16px);transform-origin:top left;touch-action:none}
@supports(height:100svh){.scene{height:100svh}}
@supports not (height:100svh){@supports(height:100dvh){.scene{height:100dvh}}}
@supports not (height:100dvh){.scene{height:100vh}}
.scene .ui{transform:scale(var(--ui-scale));transform-origin:top left;width:100%}
.hud{display:flex;align-items:center;justify-content:space-between;gap:12px;padding-right:100px}
.step{font-weight:700;color:#00E6BC;font-size:clamp(14px,3.2vw,16px)}
.progress{flex:1;height:8px;background:#E8FDF7;border-radius:8px;position:relative;overflow:hidden;border:1px solid #00E6BC22}
.progress>i{position:absolute;left:0;top:0;bottom:0;width:0;background:linear-gradient(90deg,#04FFB4,#00E6BC);transition:width .3s ease;border-right:1px solid #00E6BC}
.prompt{font-weight:700;font-size:clamp(18px,5.8vw,22px);line-height:1.15;letter-spacing:.2px;color:var(--dark);margin:6px 0 2px;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}
.blank{border-bottom:3px solid #00E6BC;display:inline-block;min-width:72px;padding:0 4px;transform:translateY(1px)}
.blank.filled{background:linear-gradient(90deg,#C5FFDF,#E8FFF5);border-color:#04FFB4;transition:all .25s ease}
.microtip{background:#C5FFDF;color:#0B214A;border:1px solid #00E6BC55;border-radius:12px;padding:8px 10px;font-size:clamp(12px,3.3vw,14px);max-width:100%}
.options{display:grid;grid-template-columns:1fr;gap:12px;margin-top:6px}
.opt{height:var(--cellH);min-height:44px;background:#fff;border:1px solid #00E6BC;border-radius:24px;box-shadow:0 8px 18px rgba(11,33,74,.12);display:flex;align-items:center;justify-content:center;padding:0 12px;color:#00E6BC;font-weight:700;font-size:clamp(16px,5vw,18px);cursor:pointer;user-select:none}
.opt:disabled{opacity:.45;box-shadow:none;cursor:default}
.opt:focus-visible{outline:3px solid #00E6BC88;outline-offset:3px}
.opt span{display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;text-align:center}
.footer{display:flex;align-items:center;justify-content:center;height:1px}
.avatar{position:absolute;right:8px;bottom:8px;width:160px;max-width:40vw;opacity:.14;pointer-events:none;user-select:none}
.fadeIn{animation:fade .3s ease}
@keyframes fade{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:none}}
.compact .prompt{font-size:clamp(16px,4.8vw,18px)}
.compact .opt{height:calc(var(--cellH) - 6px);font-size:clamp(14px,4.5vw,16px)}
.compact .hud{gap:8px}
.overlay{position:fixed;inset:0;background:rgba(26,27,47,.12);backdrop-filter:saturate(160%) blur(2px);display:flex;align-items:center;justify-content:center;padding:16px}
.modal{background:#fff;border:1px solid #00E6BC44;border-radius:20px;max-width:520px;width:min(92%,520px);max-height:90svh;overflow-y:auto;padding:16px 16px 18px}
.modal h1{margin:6px 0 8px;font-size:clamp(20px,6.2vw,26px);color:var(--dark)}
.modal p{margin:6px 0 10px;font-size:clamp(14px,4.2vw,16px);color:var(--dark)}
.modal .cta{width:100%;margin-top:8px;background:var(--blue);color:var(--teal);border:none;border-radius:24px;height:52px;font-weight:700;font-size:clamp(16px,5vw,18px);box-shadow:0 8px 18px rgba(11,33,74,.25)}
.modal .tag{display:inline-block;background:#C5FFDF;color:#0B214A;border:1px solid #00E6BC55;border-radius:12px;padding:6px 10px;font-size:13px;margin-top:6px}
.hidden{display:none!important}
.results{position:relative;max-width:720px;margin:0 auto;padding:calc(env(safe-area-inset-top) + 12px) 16px calc(env(safe-area-inset-bottom) + 24px)}
.results h2{font-size:clamp(20px,6.2vw,26px);margin:2px 0 8px}
.res-head{display:flex;align-items:center;justify-content:space-between;margin-bottom:6px}
.res-cards{display:flex;flex-direction:column;gap:12px;margin-top:8px}
.card{border:1px solid #00E6BC66;border-radius:14px;padding:10px 12px;background:#fff}
.card.ok{border-color:#04FFB4}
.card.ko{border-color:#F9577E}
.card .phrase{font-weight:700;color:#0B214A}
.card .ins{color:#00E6BC;border-bottom:2px solid #04FFB4}
.card .ans{display:flex;align-items:center;gap:6px;margin-top:4px}
.badge{font-size:12px;border-radius:10px;padding:2px 8px;border:1px solid transparent}
.badge.ok{color:#0B214A;border-color:#04FFB4;background:#E8FFF7}
.badge.ko{color:#fff;background:#F9577E;border-color:#F9577E}
.card p{font-size:14px;margin:6px 0 2px;color:#333}
.tip{background:#C5FFDF;border:1px solid #00E6BC66;border-radius:14px;padding:10px 12px;margin:12px 0;color:#0B214A}
.sticky-cta{position:sticky;bottom:8px;z-index:3;background:#fff;padding-top:6px}
.btn{width:100%;height:54px;background:var(--blue);color:var(--teal);border:none;border-radius:24px;font-weight:700;box-shadow:0 8px 18px rgba(11,33,74,.25)}
.icon{width:16px;height:16px;border-radius:50%}
.icon.ok{background:#04FFB4}
.icon.ko{background:#F9577E}
</style></head><body>
<div class="scene" id="scene" aria-live="polite">
  <img class="avatar" src="https://techkampe.github.io/daily-streak/assets/Avatar 3_low.png" alt="" aria-hidden="true">
  <div class="ui">
    <div class="hud">
      <div class="step" id="stepLabel">1/6</div>
      <div class="progress" aria-hidden="true"><i id="bar"></i></div>
    </div>
    <div class="prompt" id="prompt"></div>
    <div class="microtip" id="microtip">Elige la opción correcta para completar la frase.</div>
    <div class="options" id="options" role="listbox" aria-label="Opciones"></div>
    <div class="footer" aria-hidden="true"></div>
  </div>
</div>

<div class="overlay" id="intro">
  <div class="modal" role="dialog" aria-modal="true" aria-labelledby="t1">
    <h1 id="t1">Código Eléctrico: Habla como un pro ⚡️</h1>
    <p>Primer día en obra. Tu senior habla jerga real. Domina términos clave para comunicarte con seguridad y evitar errores.</p>
    <p>Completa 6 frases eligiendo el término correcto. Listo para sonar como pro?</p>
    <span class="tag">Tip: Toca la respuesta y avanza de inmediato.</span>
    <button class="cta" id="startBtn" aria-label="Comenzar el reto">Empezar</button>
  </div>
</div>

<div class="results hidden" id="results" aria-live="polite">
  <div class="res-head">
    <h2>Resumen del reto</h2>
    <div class="badge ok" id="scoreBadge">0/6 correctas</div>
  </div>
  <div class="res-cards" id="resCards"></div>
  <div class="tip" id="finalTip">Consejo: usa “magnetotérmico” para protección por sobrecorriente, “diferencial” para fugas, y “conmutador” cuando una luz se acciona desde dos puntos.</div>
  <div class="sticky-cta">
    <button class="btn" onclick="completeTask()">Ver mi recompensa</button>
  </div>
</div>

<script>
const items=[{p:"Para medir tensión uso el ___",o:["multímetro","buscapolos"],c:0,e:"El multímetro mide V, I y R. El buscapolos solo detecta presencia de fase, no cuantifica."},{p:"Para detectar fase uso un ___",o:["buscapolos","diferencial"],c:0,e:"El buscapolos indica fase con luz/LED. El diferencial es un protector, no un comprobador."},{p:"El ___ protege de sobrecarga y corto",o:["magnetotérmico","conmutador"],c:0,e:"El magnetotérmico actúa por sobrecorriente/cortocircuito. El conmutador solo conmuta luces."},{p:"El ___ abre ante fugas a tierra",o:["diferencial","interruptor simple"],c:0,e:"El diferencial detecta corrientes de fuga y desconecta. Un interruptor simple no protege."},{p:"Para encender desde dos puntos: un ___",o:["conmutador","interruptor simple"],c:0,e:"El conmutador (dos vías) permite accionar una luz desde dos lugares. El simple solo desde uno."},{p:"El cable verde-amarillo es la ___",o:["tierra (PE)","neutro"],c:0,e:"El verde-amarillo es el conductor de protección (tierra/PE). El neutro suele ser azul."}];
const maxOptLen=48;
let idx=0,answers=[];
const scene=document.getElementById("scene");
const promptEl=document.getElementById("prompt");
const optionsEl=document.getElementById("options");
const bar=document.getElementById("bar");
const stepLabel=document.getElementById("stepLabel");
const intro=document.getElementById("intro");
const results=document.getElementById("results");
const resCards=document.getElementById("resCards");
const microtip=document.getElementById("microtip");
function truncate(s,max){return s.length>max?s.slice(0,max-1)+"…":s}
function render(){const it=items[idx];const parts=it.p.split("___");promptEl.innerHTML=`${parts[0]}<span class="blank" id="blank">___</span>${parts[1]||""}`;optionsEl.innerHTML="";it.o.forEach((label,i)=>{const btn=document.createElement("button");btn.className="opt fadeIn";btn.setAttribute("role","option");btn.setAttribute("aria-label",`Completar con ${label}`);btn.innerHTML=`<span>${truncate(label,maxOptLen)}</span>`;btn.onclick=()=>choose(i);optionsEl.appendChild(btn)});stepLabel.textContent=`${idx+1}/${items.length}`;bar.style.width=((idx)/items.length*100)+"%";ensureFits()}
function choose(i){const it=items[idx];const blank=document.getElementById("blank");const chosen=it.o[i];answers.push(i);Array.from(optionsEl.children).forEach(b=>b.disabled=true);blank.textContent=chosen;blank.classList.add("filled");setTimeout(()=>{idx++;if(idx<items.length){render()}else{bar.style.width="100%";setTimeout(showResults,500)}},560)}
function showResults(){document.documentElement.style.overflowY="auto";document.body.style.overflowY="auto";document.documentElement.style.overscrollBehavior="auto";document.body.style.overscrollBehavior="auto";scene.classList.add("hidden");results.classList.remove("hidden");const total=items.length;let ok=0;resCards.innerHTML="";items.forEach((it,k)=>{const correct=it.o[it.c];const ans=it.o[answers[k]];const isOk=answers[k]===it.c;ok+=isOk?1:0;const parts=it.p.split("___");const card=document.createElement("div");card.className=`card ${isOk?"ok":"ko"}`;card.innerHTML=`<div class="phrase">${parts[0]}<span class="ins">${correct}</span>${parts[1]||""}</div><div class="ans"><span class="icon ${isOk?"ok":"ko"}"></span><span class="badge ${isOk?"ok":"ko"}">Tu respuesta: ${ans}</span></div><p>${truncate(it.e,180)}</p>`;resCards.appendChild(card)});document.getElementById("scoreBadge").textContent=`${ok}/${total} correctas`}
function start(){intro.classList.add("hidden");document.documentElement.style.overflow="hidden";document.body.style.overflow="hidden";render()}
document.getElementById("startBtn").addEventListener("click",start);
function assertNoOverflow(){const s=scene;return s.scrollHeight<=s.clientHeight}
function applyCompactMode(on){scene.classList.toggle("compact",!!on)}
function fitBoardToViewport(){document.documentElement.style.setProperty("--cellH","52px")}
function autoscaleUI(){const s=scene;const ui=s.querySelector(".ui");let scale=1;const tries=[1,.98,.95,.92,.9,.88];for(const t of tries){ui.style.setProperty("--ui-scale",t);ui.style.transform=`scale(${t})`;if(assertNoOverflow()){scale=t;break}}document.documentElement.style.setProperty("--ui-scale",scale)}
function ensureFits(){applyCompactMode(false);document.documentElement.style.setProperty("--ui-scale",1);scene.querySelector(".ui").style.transform="scale(1)";if(assertNoOverflow())return;applyCompactMode(true);if(assertNoOverflow())return;fitBoardToViewport();if(assertNoOverflow())return;autoscaleUI()}
window.addEventListener("resize",()=>ensureFits());
window.addEventListener("orientationchange",()=>setTimeout(ensureFits,200));
document.addEventListener("DOMContentLoaded",()=>ensureFits());
</script>

<button onclick="completeTask()" class="hidden">Ver mi recompensa</button>
<script>
function completeTask(){if(window.ReactNativeWebView){window.ReactNativeWebView.postMessage(JSON.stringify({action:'TASK_COMPLETED'}))}}
</script>
</body></html>