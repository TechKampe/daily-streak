<!DOCTYPE html><html lang="es"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/><title>¿Chispa de memoria? ⚡️</title><link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@600;700&display=swap" rel="stylesheet"><style>
:root{--txt:#1A1B2F;--cta:#0B214A;--ctaTxt:#00E6BC;--border:#00E6BC;--green:#04FFB4;--pink:#F9577E;--soft:#C5FFDF;--ui-scale:1;--cellH:124px;--gap:10px;--cols:4;}
*{box-sizing:border-box}
html,body{height:100%;margin:0;font-family:"Baloo 2",system-ui,-apple-system,Segoe UI,Roboto,sans-serif;color:var(--txt);background:#fff;overflow:hidden;overscroll-behavior:none}
button{font-family:inherit}
.scene{position:relative;display:flex;flex-direction:column;transform-origin:top left;transform:scale(var(--ui-scale));padding:calc(env(safe-area-inset-top) + 80px) 16px 16px 16px;padding-right:calc(env(safe-area-inset-right) + 16px);padding-bottom:calc(env(safe-area-inset-bottom) + 16px);gap:10px}
@supports (height:100svh){.scene{height:100svh}}
@supports not (height:100svh){@supports (height:100dvh){.scene{height:100dvh}}}
@supports not (height:100dvh){.scene{height:100vh}}
.reserve-notch{position:absolute;top:0;right:0;width:100px;height:140px;pointer-events:none}
.avatar{position:absolute;left:10px;bottom:12px;opacity:.12;max-width:36vw;max-height:36vh;z-index:0;user-select:none}
.header{z-index:1}
h1{margin:0;font-weight:800;letter-spacing:.2px;font-size:clamp(20px,4.3vw,28px)}
.desc{margin:2px 0 0 0;font-size:clamp(12px,2.8vw,14px);line-height:1.25}
.tutorial{background:#C5FFDF;color:#0B214A;border:1px solid #00E6BC;border-radius:12px;padding:8px 10px;font-size:clamp(12px,2.8vw,14px);display:flex;align-items:center;gap:8px}
.hud{display:flex;justify-content:space-between;align-items:center;gap:8px}
.badge{min-width:90px;text-align:center;padding:8px 10px;border:1px solid var(--border);border-radius:12px;font-size:14px}
.board{flex:1;display:grid;grid-template-columns:repeat(var(--cols),1fr);gap:var(--gap);touch-action:none;z-index:1}
.card{position:relative;height:var(--cellH);border-radius:14px;border:1px solid var(--border);perspective:800px;outline:none}
.card:focus-visible{box-shadow:0 0 0 3px rgba(0,230,188,.6)}
.inner{position:absolute;inset:0;transition:transform .35s ease,box-shadow .25s;transform-style:preserve-3d;border-radius:14px;background:#fff}
.face{position:absolute;inset:0;backface-visibility:hidden;border-radius:14px;display:flex;align-items:center;justify-content:center;padding:8px 10px;text-align:center}
.front{background:#fff}
.back{transform:rotateY(180deg);background:#fff}
.card .label{display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;text-overflow:ellipsis;font-size:clamp(12px,2.9vw,16px);line-height:1.2;padding:0 2px}
.card.flipped .inner{transform:rotateY(180deg) scale(1.02)}
.card.matched .inner{box-shadow:0 0 0 2px var(--green),0 8px 18px rgba(11,33,74,.12)}
.card.wrong .inner{box-shadow:0 0 0 2px var(--pink)}
.controls{display:flex;justify-content:space-between;align-items:center;gap:8px}
.btn{background:var(--cta);color:var(--ctaTxt);border:none;border-radius:24px;padding:12px 16px;font-size:clamp(14px,3.4vw,16px);box-shadow:0 8px 18px rgba(11,33,74,.25);min-height:44px;min-width:44px}
.btn:disabled{opacity:.45;box-shadow:none}
.btn.secondary{background:transparent;color:var(--cta);border:1px solid var(--border);box-shadow:none}
.modal{position:fixed;inset:0;background:rgba(26,27,47,.1);display:flex;align-items:flex-end;justify-content:center;padding:16px;z-index:10}
.modal>div{background:#fff;border:1px solid var(--border);border-radius:16px;max-height:90svh;overflow-y:auto;width:100%;max-width:560px;padding:16px;box-shadow:0 8px 18px rgba(11,33,74,.15)}
.modal h2{margin:4px 0 8px 0;font-size:clamp(18px,4.6vw,24px)}
.modal p{margin:6px 0;font-size:clamp(13px,3vw,15px);line-height:1.25}
.modal .footer{display:flex;gap:10px;justify-content:flex-end;margin-top:8px;position:sticky;bottom:0;background:#fff;padding-top:6px}
.results{position:fixed;inset:0;background:#fff;z-index:12;display:none;flex-direction:column;padding:calc(env(safe-area-inset-top) + 16px) 16px calc(env(safe-area-inset-bottom) + 16px);overflow-y:auto}
.results h2{margin:0 0 8px 0;font-size:clamp(18px,4.6vw,24px)}
.kpis{display:flex;gap:8px;margin-bottom:8px}
.kpi{flex:1;border:1px solid var(--border);border-radius:12px;padding:10px;text-align:center}
.pairs{display:grid;grid-template-columns:1fr;gap:10px}
.pair{border:1px solid var(--border);border-radius:12px;padding:10px}
.pair h3{margin:0 0 4px 0;font-size:16px}
.pair p{margin:0;font-size:14px}
.tip{background:#C5FFDF;border:1px solid var(--border);border-radius:12px;padding:10px;margin:8px 0}
.results .footer{position:sticky;bottom:0;background:#fff;padding-top:8px;display:flex;gap:10px}
.compact h1{font-size:18px}.compact .desc{font-size:12px}.compact .tutorial{font-size:12px;padding:6px 8px}.compact .badge{min-width:78px;padding:6px 8px;font-size:12px}.compact .board{gap:8px}.compact .btn{padding:10px 14px;font-size:14px}.compact .card .label{font-size:12px}
</style></head><body>
<div class="scene" id="scene">
<div class="reserve-notch" aria-hidden="true"></div>
<img src="https://techkampe.github.io/daily-streak/assets/Avatar 2_low.png" alt="" class="avatar" loading="lazy">
<div class="header">
<h1>¿Chispa de memoria? ⚡️</h1>
<p class="desc">Estás en tu primer día como ayudante de electricista: empareja cada herramienta con su uso principal.</p>
</div>
<div class="tutorial" aria-live="polite">Destapa dos cartas por turno. Tienes 12 intentos: ¡precisión ante todo!</div>
<div class="hud">
<div class="badge" id="triesBadge" aria-live="polite">Intentos: 12</div>
<div class="badge" id="pairsBadge" aria-live="polite">Parejas: 0/4</div>
</div>
<div class="board" id="board" aria-label="Tablero de memorama"></div>
<div class="controls"><button class="btn secondary" id="resetBtn" aria-label="Reiniciar partida">Reiniciar</button><button class="btn" id="finishBtn" aria-label="Terminar y ver resultados" disabled>Terminar</button></div>
</div>

<div class="modal" id="intro" role="dialog" aria-modal="true" aria-labelledby="introTitle" style="display:flex">
<div>
<h2 id="introTitle">Organiza por función</h2>
<p>Empareja herramienta con uso. Si fallas, se tapan tras 1 s. Encuentra las 4 parejas con máximo 12 intentos.</p>
<div class="footer"><button class="btn" id="startBtn">¡Comenzar!</button></div>
</div>
</div>

<div class="results" id="results" role="dialog" aria-modal="true" aria-labelledby="resTitle">
<h2 id="resTitle">Resumen del reto</h2>
<div class="kpis">
<div class="kpi" id="kpi1">Aciertos: 0/4</div>
<div class="kpi" id="kpi2">Intentos usados: 0</div>
<div class="kpi" id="kpi3">Fallos: 0</div>
</div>
<div class="pairs" id="pairsExplain"></div>
<div class="tip">Consejo: Asocia herramienta con un gesto. Repite en voz alta “Buscapolos → detectar fase”, “Pelacables → retirar aislamiento”. Espacia repasos cada pocas horas.</div>
<div class="footer">
<button class="btn secondary" id="playAgain">Jugar de nuevo</button>
<button class="btn" onclick="completeTask()">Ver mi recompensa</button>
</div>
</div>

<script>
const root=document.documentElement,scene=document.getElementById("scene"),board=document.getElementById("board"),triesBadge=document.getElementById("triesBadge"),pairsBadge=document.getElementById("pairsBadge"),finishBtn=document.getElementById("finishBtn"),resetBtn=document.getElementById("resetBtn"),intro=document.getElementById("intro"),results=document.getElementById("results"),kpi1=document.getElementById("kpi1"),kpi2=document.getElementById("kpi2"),kpi3=document.getElementById("kpi3"),pairsExplain=document.getElementById("pairsExplain");
let MAX_TRIES=12,tries=MAX_TRIES,found=0,first=null,lock=false,deck=[],stats={successPairs:0,attempts:0,errors:0};
const pairsData=[{id:"p1",a:"Multímetro",b:"Medir tensión",blurb:"El multímetro mide tensión, corriente y continuidad. Verifica el circuito antes de trabajar."},{id:"p2",a:"Buscapolos",b:"Detectar fase",blurb:"El buscapolos identifica la presencia de fase en un conductor. Comprueba si hay tensión al tocar el vivo."},{id:"p3",a:"Pelacables",b:"Retirar aislamiento",blurb:"Herramienta para quitar la cubierta sin dañar el cobre. Prepara puntas limpias para conectar o crimpar."},{id:"p4",a:"Alicates de corte",b:"Cortar cables",blurb:"Permiten cortes limpios en cables finos. Úsalos antes de pelar o empalmar para evitar hilos abiertos."}];
function clampText(t,max){t=t.trim();return t.length>max?t.slice(0,max-1)+"…":t}
function buildDeck(){const d=[];pairsData.forEach(p=>{d.push({pid:p.id,text:clampText(p.a,48),side:"tool"},{pid:p.id,text:clampText(p.b,48),side:"use"})});return d.sort(()=>Math.random()-.5)}
function renderBoard(){board.innerHTML="";deck=buildDeck();deck.forEach((c,i)=>{const btn=document.createElement("button");btn.className="card";btn.setAttribute("data-index",i);btn.setAttribute("data-pid",c.pid);btn.setAttribute("aria-label","Carta");btn.setAttribute("tabindex","0");btn.innerHTML='<div class="inner"><div class="face front"><div class="label">?</div></div><div class="face back"><div class="label">'+c.text+'</div></div></div>';btn.addEventListener("click",()=>flip(btn));board.appendChild(btn)});ensureFits()}
function updateHUD(){triesBadge.textContent="Intentos: "+tries;pairsBadge.textContent="Parejas: "+found+"/4";finishBtn.disabled=found<4&&tries>0}
function flip(card){if(lock||card.classList.contains("flipped")||card.classList.contains("matched"))return;card.classList.add("flipped");if(!first){first=card;return}
lock=true;stats.attempts++;tries--;updateHUD();const pid1=first.dataset.pid,pid2=card.dataset.pid;const match=pid1===pid2&&first!==card;if(match){first.classList.add("matched");card.classList.add("matched");found++;stats.successPairs++;flash(card,true);flash(first,true);resetTurn();if(found===4||tries===0)endGame()}else{first.classList.add("wrong");card.classList.add("wrong");setTimeout(()=>{first.classList.remove("flipped","wrong");card.classList.remove("flipped","wrong");resetTurn();if(tries===0)endGame()},1000);stats.errors++}}
function flash(el,ok){el.classList.add(ok?"matched":"wrong");setTimeout(()=>el.classList.remove("wrong"),800)}
function resetTurn(){first=null;lock=false;updateHUD()}
function startGame(){tries=MAX_TRIES;found=0;first=null;lock=false;stats={successPairs:0,attempts:0,errors:0};renderBoard();updateHUD()}
function endGame(){showResults()}
function showIntro(){intro.style.display="flex";disableScrollGameplay(false)}
function closeIntro(){intro.style.display="none";disableScrollGameplay(true)}
function disableScrollGameplay(on){if(on){document.documentElement.classList.remove("results-open");document.body.classList.remove("results-open");document.documentElement.style.overflow="hidden";document.body.style.overflow="hidden"}else{document.documentElement.style.overflow="hidden";document.body.style.overflow="hidden"}}
function openResults(){results.style.display="flex";document.documentElement.classList.add("results-open");document.body.classList.add("results-open");document.documentElement.style.overflowY="auto";document.body.style.overflowY="auto";document.documentElement.style.overscrollBehavior="auto";document.body.style.overscrollBehavior="auto"}
function closeResults(){results.style.display="none";disableScrollGameplay(true)}
function showResults(){kpi1.textContent="Aciertos: "+found+"/4";kpi2.textContent="Intentos usados: "+stats.attempts;kpi3.textContent="Fallos: "+Math.max(0,stats.attempts-found);pairsExplain.innerHTML="";pairsData.forEach(p=>{const got=[...board.querySelectorAll('.card.matched[data-pid="'+p.id+'"]')].length===2;const h=document.createElement("div");h.className="pair";h.innerHTML="<h3>"+p.a+" ↔ "+p.b+(got?' <span style=color:#00E6BC>✓</span>':' <span style=color:#F9577E>•</span>')+"</h3><p>"+clampText(p.blurb,180)+"</p>";pairsExplain.appendChild(h)});openResults()}
document.getElementById("startBtn").addEventListener("click",()=>{closeIntro();startGame()});resetBtn.addEventListener("click",()=>startGame());finishBtn.addEventListener("click",()=>endGame());document.getElementById("playAgain").addEventListener("click",()=>{closeResults();startGame()});
function assertNoOverflow(){return scene.scrollHeight<=scene.clientHeight+1}
function applyCompactMode(){if(!scene.classList.contains("compact"))scene.classList.add("compact")}
function fitBoardToViewport(){let ch=parseInt(getComputedStyle(root).getPropertyValue("--cellH"))||124;let gap=parseInt(getComputedStyle(root).getPropertyValue("--gap"))||10;while(!assertNoOverflow()&&ch>92){ch-=4;root.style.setProperty("--cellH",ch+"px")}if(!assertNoOverflow()&&gap>6){root.style.setProperty("--gap","8px")}}
function autoscaleUI(){let s=parseFloat(getComputedStyle(root).getPropertyValue("--ui-scale"))||1;if(!assertNoOverflow()){s=Math.max(.88,s-.04);root.style.setProperty("--ui-scale",s)}}
function ensureFits(){root.style.setProperty("--cols","4");if(!assertNoOverflow())applyCompactMode();fitBoardToViewport();autoscaleUI()}
window.addEventListener("resize",ensureFits);window.addEventListener("orientationchange",()=>setTimeout(ensureFits,200));
showIntro();
</script>
<script>
function completeTask(){if(window.ReactNativeWebView){window.ReactNativeWebView.postMessage(JSON.stringify({action:'TASK_COMPLETED'}))}}
</script>
</body></html>