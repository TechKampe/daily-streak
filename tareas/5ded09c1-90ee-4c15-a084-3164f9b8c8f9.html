
<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover,user-scalable=no">
<title>Misi√≥n Reciclaje - K√§mpe</title>
<link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@400;600;700&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box}
html,body{width:100%;overflow:hidden;overscroll-behavior:none;font-family:'Baloo 2',sans-serif;background:#F5F5F0;color:#1A1B2F}
@supports(height:100svh){.scene{height:100svh}}
@supports not(height:100svh){.scene{height:100dvh}}
@supports not(height:100dvh){.scene{height:100vh}}
.scene{width:100%;display:flex;flex-direction:column;position:relative;overflow:hidden;padding:env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left)}
.scene.results{overflow-y:auto}
.bg-avatar{position:absolute;top:0;left:0;width:100%;height:100%;background:url('https://techkampe.github.io/daily-streak/assets/Avatar%202_low.png') center bottom/contain no-repeat;opacity:0.08;pointer-events:none;z-index:0}
.header{padding:12px 16px;display:flex;align-items:center;justify-content:space-between;position:relative;z-index:2;flex-shrink:0}
.logo{height:28px;width:auto}
.progress{font-size:clamp(14px,3.5vw,16px);font-weight:600;color:#007BFF}
.content{flex:1;display:flex;flex-direction:column;justify-content:center;align-items:center;padding:16px;position:relative;z-index:1;overflow:hidden}
.modal{background:#FFF;border-radius:20px;padding:28px 24px;max-width:90%;max-height:90svh;overflow-y:auto;box-shadow:0 8px 24px rgba(0,0,0,0.15);text-align:center}
.modal h1{font-size:clamp(22px,5vw,28px);margin-bottom:12px;color:#1A1B2F;line-height:1.2}
.modal p{font-size:clamp(14px,3.5vw,16px);color:#4A4A5E;margin-bottom:20px;line-height:1.4}
.btn{background:linear-gradient(135deg,#1EA4FF,#007BFF);color:#FFF;border:none;padding:14px 28px;border-radius:12px;font-size:clamp(15px,4vw,17px);font-weight:600;cursor:pointer;font-family:'Baloo 2',sans-serif;min-height:48px;box-shadow:0 4px 12px rgba(30,164,255,0.3);transition:transform 0.2s;touch-action:manipulation}
.btn:active{transform:scale(0.96)}
.item-card{background:#FFF;border-radius:16px;padding:20px 16px;box-shadow:0 4px 16px rgba(0,0,0,0.1);margin-bottom:20px;max-width:320px;width:100%;text-align:center;flex-shrink:0}
.item-card h2{font-size:clamp(18px,4.5vw,22px);color:#1A1B2F;margin-bottom:8px;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;line-height:1.3}
.categories{display:flex;gap:10px;justify-content:center;flex-wrap:wrap;max-width:100%;flex-shrink:0}
.cat-btn{background:linear-gradient(135deg,#1EA4FF,#007BFF);color:#FFF;border:none;padding:12px 16px;border-radius:10px;font-size:clamp(13px,3.2vw,15px);font-weight:600;cursor:pointer;font-family:'Baloo 2',sans-serif;min-height:48px;min-width:90px;box-shadow:0 3px 10px rgba(30,164,255,0.25);transition:all 0.2s;touch-action:manipulation;flex:1;max-width:140px}
.cat-btn:active{transform:scale(0.95)}
.cat-btn.correct{background:linear-gradient(135deg,#00C896,#00A67E);animation:pulse 0.4s}
.cat-btn.wrong{background:linear-gradient(135deg,#FF6B6B,#EE5A6F);animation:shake 0.4s}
@keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.08)}}
@keyframes shake{0%,100%{transform:translateX(0)}25%{transform:translateX(-8px)}75%{transform:translateX(8px)}}
.drop-anim{animation:drop 0.5s ease-out}
@keyframes drop{0%{transform:translateY(-60px) scale(0.8);opacity:0}60%{transform:translateY(10px) scale(1.05)}100%{transform:translateY(0) scale(1);opacity:1}}
.results-list{text-align:left;margin:20px 0;max-width:100%}
.result-item{background:#F9F9F9;border-left:4px solid #007BFF;padding:12px 14px;margin-bottom:12px;border-radius:8px;font-size:clamp(13px,3.2vw,15px);line-height:1.4}
.result-item.correct{border-left-color:#00C896}
.result-item.wrong{border-left-color:#FF6B6B}
.result-item strong{display:block;color:#1A1B2F;margin-bottom:4px}
.result-item span{color:#4A4A5E;font-size:clamp(12px,3vw,14px)}
.final-tip{background:linear-gradient(135deg,#E3F2FD,#BBDEFB);padding:16px;border-radius:12px;margin:16px 0;color:#1A1B2F;font-size:clamp(13px,3.2vw,15px);line-height:1.4}
.score{font-size:clamp(20px,5vw,26px);font-weight:700;color:#007BFF;margin:12px 0}
.compact .header{padding:8px 12px}
.compact .logo{height:24px}
.compact .progress{font-size:clamp(12px,3vw,14px)}
.compact .item-card{padding:16px 12px;margin-bottom:16px}
.compact .item-card h2{font-size:clamp(16px,4vw,20px)}
.compact .cat-btn{padding:10px 12px;font-size:clamp(12px,3vw,14px);min-height:44px}
.compact .modal{padding:20px 16px}
</style>
</head>
<body>
<div class="scene" id="app">
<div class="bg-avatar"></div>
<div class="header">
<img src="https://techkampe.github.io/daily-streak/assets/kampe_logo_blanco.png" alt="K√§mpe" class="logo">
<div class="progress" id="progress"></div>
</div>
<div class="content" id="content"></div>
</div>
<script>
const items=[
{name:'Botes de disolvente',correct:'Peligroso',exp:'Los disolventes son qu√≠micos inflamables y t√≥xicos que requieren gesti√≥n especial.'},
{name:'Restos de pladur',correct:'Inerte',exp:'El pladur (yeso laminado) es un residuo inerte no peligroso ni reciclable en el ciclo convencional.'},
{name:'Cart√≥n de embalaje',correct:'Reciclable',exp:'El cart√≥n limpio se recicla f√°cilmente en el contenedor azul o punto limpio.'},
{name:'Trozos de ladrillo',correct:'Inerte',exp:'Los ladrillos y escombros cer√°micos son inertes, se llevan a gestor o contenedor de escombros.'},
{name:'Latas de pintura',correct:'Peligroso',exp:'Las pinturas contienen componentes t√≥xicos y deben gestionarse como residuo peligroso.'},
{name:'Botellas de pl√°stico',correct:'Reciclable',exp:'El pl√°stico limpio (envases) va al contenedor amarillo o punto limpio para reciclaje.'},
{name:'Cables el√©ctricos',correct:'Reciclable',exp:'Los cables contienen cobre y otros metales reciclables, se llevan a punto limpio o chatarrero.'},
{name:'Trapos con aceite',correct:'Peligroso',exp:'Los trapos impregnados con aceite u otros qu√≠micos son residuos peligrosos.'},
{name:'Arena de cemento',correct:'Inerte',exp:'La arena y el cemento endurecido son residuos inertes, van a contenedor de escombros.'},
{name:'Tubos fluorescentes',correct:'Peligroso',exp:'Los fluorescentes contienen mercurio, son peligrosos y requieren gesti√≥n especial.'}
];
const categories=['Peligroso','Reciclable','Inerte'];
let currentIndex=0,answers=[],initData='';
function getInitData(){
const u=new URLSearchParams(window.location.search);
initData=u.get('initData')||'';
}
function showIntro(){
document.getElementById('content').innerHTML=`
<div class="modal">
<h1>‚ôªÔ∏è Misi√≥n Reciclaje</h1>
<p>Clasifica 10 residuos en su contenedor correcto: Peligroso, Reciclable o Inerte. ¬°Toca la categor√≠a adecuada!</p>
<button class="btn" onclick="startGame()">Empezar</button>
</div>`;
}
function startGame(){
currentIndex=0;
answers=[];
showItem();
}
function showItem(){
if(currentIndex>=items.length){
showResults();
return;
}
const item=items[currentIndex];
document.getElementById('progress').textContent=`${currentIndex+1}/${items.length}`;
document.getElementById('content').innerHTML=`
<div class="item-card drop-anim">
<h2>${item.name}</h2>
</div>
<div class="categories">
${categories.map(c=>`<button class="cat-btn" onclick="selectCategory('${c}')">${c}</button>`).join('')}
</div>`;
ensureFits();
}
function selectCategory(selected){
const item=items[currentIndex];
const isCorrect=selected===item.correct;
answers.push({item:item.name,selected,correct:item.correct,isCorrect,exp:item.exp});
const btns=document.querySelectorAll('.cat-btn');
btns.forEach(b=>{
if(b.textContent===selected){
b.classList.add(isCorrect?'correct':'wrong');
}
b.disabled=true;
});
setTimeout(()=>{
currentIndex++;
showItem();
},800);
}
function showResults(){
const correct=answers.filter(a=>a.isCorrect).length;
const total=answers.length;
document.getElementById('app').classList.add('results');
document.getElementById('progress').textContent='';
document.getElementById('content').innerHTML=`
<div class="modal">
<h1>üéâ ¬°Misi√≥n completada!</h1>
<div class="score">${correct}/${total} correctas</div>
<div class="results-list">
${answers.map(a=>`
<div class="result-item ${a.isCorrect?'correct':'wrong'}">
<strong>${a.item}</strong>
<span>Tu respuesta: ${a.selected} ${a.isCorrect?'‚úì':'‚úó'}</span><br>
<span>Correcta: ${a.correct}. ${a.exp}</span>
</div>
`).join('')}
</div>
<div class="final-tip">
üí° <strong>Consejo:</strong> En obra, piensa siempre: ¬øes qu√≠mico/t√≥xico? ‚Üí Peligroso. ¬øEs metal/papel/pl√°stico limpio? ‚Üí Reciclable. ¬øEs escombro/cer√°mica? ‚Üí Inerte.
</div>
<button class="btn" onclick="goToReward()">Ver mi recompensa</button>
${initData?'':'<p style="font-size:12px;color:#999;margin-top:8px">‚ö†Ô∏è initData no detectado</p>'}
</div>`;
}
function goToReward(){
const url=`https://kampe-game-phaser.onrender.com/daily_streak?initData=${encodeURIComponent(initData)}`;
window.location.href=url;
}
function ensureFits(){
const scene=document.querySelector('.scene');
if(!scene||scene.classList.contains('results'))return;
const content=document.getElementById('content');
if(content.scrollHeight>content.clientHeight){
scene.classList.add('compact');
}
setTimeout(()=>{
if(content.scrollHeight>content.clientHeight){
const scale=Math.max(0.88,content.clientHeight/content.scrollHeight);
content.style.transform=`scale(${scale})`;
content.style.transformOrigin='top center';
}
},50);
}
window.addEventListener('resize',ensureFits);
window.addEventListener('orientationchange',ensureFits);
getInitData();
showIntro();
</script>
</body>
</html>

