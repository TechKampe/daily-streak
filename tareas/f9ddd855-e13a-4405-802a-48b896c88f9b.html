<!DOCTYPE html><html lang="es"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/><title>Caja de herramientas PRO üîß</title><link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@400;600;700&display=swap" rel="stylesheet"/><style>
:root{--bg:#FFFFFF;--txt:#1A1B2F;--cta:#0B214A;--ctaTxt:#00E6BC;--acc:#00E6BC;--succ:#04FFB4;--err:#F9577E;--mut:#C5FFDF;--ui-scale:1;--cellH:72px;--cellAR:6/1;--gap:12px}
*{box-sizing:border-box;-webkit-tap-highlight-color:transparent}
html,body{height:100%;margin:0;background:#fff;color:var(--txt);font-family:"Baloo 2",system-ui,Segoe UI,Arial,sans-serif}
body.no-scroll{overflow:hidden;overscroll-behavior:none}
body.results-open{overflow-y:auto}
button{font-family:inherit}
.scene{position:relative;width:100%;max-width:720px;margin:0 auto;transform:scale(var(--ui-scale));transform-origin:top center;padding:16px 16px calc(16px + env(safe-area-inset-bottom));padding-top:calc(16px + env(safe-area-inset-top));touch-action:none}
.scene{height:100vh}
@supports(height:100dvh){.scene{height:100dvh}}
@supports(height:100svh){.scene{height:100svh}}
.safe-gap{height:80px;width:100%}
.no-ui-zone{position:absolute;top:0;right:0;width:100px;height:100px;pointer-events:none}
.avatar{position:absolute;right:12px;bottom:100px;opacity:.08;width:160px;max-width:38vw;filter:saturate(0.9);z-index:0}
.ui{position:relative;z-index:1;display:flex;flex-direction:column;height:calc(100% - 0px);gap:8px}
.hud{display:flex;flex-direction:column;gap:8px}
.title{margin:0;font-weight:700;color:var(--txt);font-size:clamp(18px,4.2vw,26px);letter-spacing:.2px}
.topline{display:flex;align-items:center;justify-content:space-between;gap:8px}
.step{font-weight:600;color:var(--acc);font-size:clamp(12px,3.3vw,14px)}
.progress{display:flex;align-items:center;gap:8px}
.bar{flex:1;height:8px;border:1px solid var(--acc);border-radius:8px;position:relative;overflow:hidden;background:rgba(0,230,188,.08)}
.bar span{position:absolute;left:0;top:0;height:100%;background:linear-gradient(90deg,#04FFB4,#00E6BC);width:0}
.status{min-height:0;border-radius:12px;padding:6px 10px;display:none;align-items:center;gap:8px;font-size:13px;line-height:1.2}
.status.show{display:flex}
.status.info{background:var(--mut);color:#0B214A;border:1px dashed var(--acc)}
.status.ok{background:rgba(4,255,180,.12);color:#0B214A;border:1px solid #04FFB4}
.status.bad{background:rgba(249,87,126,.12);color:#0B214A;border:1px solid #F9577E}
.task{margin:4px 0 8px 0;font-weight:600;font-size:clamp(16px,4.2vw,20px);line-height:1.2;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}
.board{display:flex;flex-direction:column;gap:10px;flex:1;min-height:0}
.options{display:grid;grid-template-columns:1fr;gap:var(--gap);--cell-radius:18px}
.option{display:flex;align-items:center;gap:10px;justify-content:flex-start;height:var(--cellH);border:1px solid var(--acc);background:#fff;border-radius:var(--cell-radius);padding:10px 12px;box-shadow:0 8px 18px rgba(11,33,74,.08);transition:.18s transform,.18s box-shadow,.18s border-color;cursor:pointer}
.option .icon{font-size:20px;flex:0 0 26px;text-align:center}
.option .label{flex:1;font-weight:600;font-size:clamp(14px,3.8vw,16px);display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}
.option:focus-visible{outline:2px dashed var(--acc);outline-offset:2px}
.option:hover{transform:translateY(-1px)}
.option.selected{border-color:var(--cta);box-shadow:0 10px 22px rgba(11,33,74,.18)}
.option.correct{border-color:var(--succ)}
.option.wrong{border-color:var(--err)}
.cta{margin-top:auto;position:sticky;bottom:0;padding-top:4px;background:linear-gradient(180deg,rgba(255,255,255,0),#fff 40%);display:flex;gap:8px}
.primary{width:100%;height:48px;border-radius:24px;border:0;background:var(--cta);color:var(--ctaTxt);font-weight:700;font-size:clamp(14px,4vw,16px);box-shadow:0 8px 18px rgba(11,33,74,.25);cursor:pointer}
.primary:disabled{opacity:.4;box-shadow:none;cursor:not-allowed}
.modal{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(26,27,47,.36);padding:16px;z-index:10}
.card{background:#fff;border:1px solid var(--acc);border-radius:16px;max-height:90svh;overflow-y:auto;width:min(560px,92vw);padding:16px 16px 12px}
.card h2{margin:6px 0 8px 0;font-size:clamp(18px,5vw,24px);color:var(--txt)}
.card p,.card li{font-size:clamp(14px,3.7vw,16px);line-height:1.25;margin:8px 0}
.card .muted{background:var(--mut);border-radius:12px;padding:10px;border:1px dashed var(--acc);color:#0B214A}
.card .desc{margin:6px 0 12px 0}
.hidden{display:none}
.results .score{display:flex;align-items:center;gap:8px;margin:4px 0 8px 0}
.badge{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border-radius:12px;border:1px solid var(--acc);background:#fff}
.recap{list-style:none;padding:0;margin:0;display:flex;flex-direction:column;gap:10px}
.recap li{border:1px solid var(--acc);border-radius:12px;padding:10px;background:#fff}
.recap h4{margin:0 0 6px 0;font-size:16px}
.meta{display:flex;flex-wrap:wrap;gap:8px;font-size:13px}
.meta .pill{padding:4px 8px;border-radius:10px;border:1px solid var(--acc);background:#fff}
.meta .ok{border-color:#04FFB4;color:#0B214A}
.meta .bad{border-color:#F9577E;color:#0B214A}
.tip{margin-top:6px;background:var(--mut);border:1px dashed var(--acc);border-radius:10px;padding:8px;font-size:13px;color:#0B214A}
.results .actions{position:sticky;bottom:0;background:linear-gradient(180deg,rgba(255,255,255,0),#fff 50%);padding-top:10px;margin-top:10px}
.compact .title{font-size:clamp(16px,3.6vw,18px)}
.compact .task{font-size:clamp(14px,3.6vw,18px)}
.compact .status{display:none!important}
.compact .option{height:58px}
.compact .primary{height:44px}
@media (min-width:520px){.options{grid-template-columns:1fr 1fr;}.option{height:64px}}
</style></head><body class="no-scroll">
<div class="scene" id="scene">
  <div class="no-ui-zone"></div>
  <div class="safe-gap"></div>
  <img class="avatar" src="https://techkampe.github.io/daily-streak/assets/Avatar 2_low.png" alt="Avatar mentor" loading="lazy"/>
  <div class="ui" id="ui">
    <div class="hud">
      <div class="topline">
        <h1 class="title">Caja de herramientas PRO üîß</h1>
        <div class="step" aria-live="polite"><span id="stepNum">0</span>/6</div>
      </div>
      <div class="progress" aria-hidden="true"><div class="bar"><span id="barFill"></span></div></div>
      <div class="status info" id="statusMsg" role="status" aria-live="polite"></div>
    </div>
    <div class="board" id="board" role="region" aria-label="Reto de selecci√≥n">
      <div class="task" id="taskText"></div>
      <div class="options" id="options"></div>
    </div>
    <div class="cta">
      <button id="nextBtn" class="primary" disabled aria-label="Siguiente">Siguiente</button>
    </div>
  </div>
</div>

<div class="modal" id="intro" role="dialog" aria-modal="true" aria-labelledby="introTitle">
  <div class="card">
    <h2 id="introTitle">Caja de herramientas PRO üîß</h2>
    <p class="muted">Tutorial: Lee el encargo y toca la herramienta correcta. Confirma y avanza. Aprende r√°pido: s√≥lo 6 decisiones.</p>
    <p class="desc">Est√°s en tus primeras pr√°cticas de fontaner√≠a y te enfrentas a una aver√≠a real en casa de un cliente. Tu mentor te pone a prueba: debes elegir el equipo correcto para no agravar el problema. El objetivo es que aprendas a identificar la herramienta id√≥nea para las tareas m√°s comunes del oficio. Las situaciones cubren desde cortar un tubo de cobre hasta desatascar un sif√≥n o sellar una rosca. Al final, un resumen te explicar√° por qu√© cada elecci√≥n fue correcta o no y te dar√° trucos de experto. Este reto consta de 6 tareas de selecci√≥n para demostrar tu val√≠a.</p>
    <button id="startBtn" class="primary" aria-label="Empezar el reto">Empezar</button>
  </div>
</div>

<div class="modal hidden results" id="results" role="dialog" aria-modal="true" aria-labelledby="resTitle">
  <div class="card">
    <h2 id="resTitle">Resumen de la misi√≥n</h2>
    <div class="score">
      <span class="badge">Aciertos: <strong id="hits">0</strong>/6</span>
      <span class="badge">Racha diaria: <strong>+1</strong></span>
    </div>
    <ol class="recap" id="recap"></ol>
    <div class="tip">
      Trucos de experto:
      <ul id="tipsList" style="margin:6px 0 0 16px;padding:0"></ul>
    </div>
    <div class="actions">
      <button onclick="completeTask()" class="primary" aria-label="Ver mi recompensa">Ver mi recompensa</button>
    </div>
  </div>
</div>

<script>
function completeTask(){if(window.ReactNativeWebView){window.ReactNativeWebView.postMessage(JSON.stringify({action:'TASK_COMPLETED'}))}}
const data=[{task:"Cortar un tubo de cobre de 15 mm con precisi√≥n.",options:[{icon:"‚úÇÔ∏è",label:"Cortatubos de cobre",correct:true,tip:"Para cortes limpios sin limaduras; aprieta gradualmente y gira."},{icon:"ü™ö",label:"Sierra de arco",correct:false,whyWrong:"Puede dejar rebabas y desalinear el corte; √∫ltima opci√≥n."},{icon:"‚öôÔ∏è",label:"Amoladora angular",correct:false,whyWrong:"Riesgo de sobrecalentar y chispas; imprecisa en interior."}],explain:"El cortatubos hace cortes rectos sin aplastar el tubo. La sierra y la amoladora dejan rebabas y pueden deformar o sobrecalentar."},{task:"Desatascar un sif√≥n del fregadero sin desmontar.",options:[{icon:"ü™†",label:"Desatascador de copa",correct:true,tip:"Asegura buen sello con agua; bombea 10‚Äì15 veces."},{icon:"üóúÔ∏è",label:"Llave grifa",correct:false,whyWrong:"Sirve para tuercas, no genera presi√≥n en el sif√≥n."},{icon:"üåÄ",label:"Cable desatascador",correct:false,whyWrong:"Mejor para atascos profundos, no en el sif√≥n inmediato."}],explain:"El desatascador crea presi√≥n/aspiraci√≥n justo en el sif√≥n. Grifa y cable no resuelven el atasco superficial con rapidez."},{task:"Sellar la rosca de una conexi√≥n macho de 1/2‚Äù.",options:[{icon:"üßµ",label:"Cinta PTFE (tefl√≥n)",correct:true,tip:"Enr√≥llala en sentido de la rosca 6‚Äì8 vueltas, tensando."},{icon:"üß¥",label:"Silicona sanitaria",correct:false,whyWrong:"Es para juntas visibles; en roscas no garantiza estanqueidad."},{icon:"üßª",label:"Cinta aislante el√©ctrica",correct:false,whyWrong:"No sella roscas ni resiste presi√≥n/temperatura del agua."}],explain:"La cinta PTFE sella roscas y resiste presi√≥n. Silicona y cinta aislante no est√°n dise√±adas para roscas."},{task:"Apretar la tuerca de un latiguillo sin marcarla.",options:[{icon:"üîß",label:"Llave ajustable (inglesa)",correct:true,tip:"Ajusta la boca al mil√≠metro y sujeta por las caras planas."},{icon:"üóúÔ∏è",label:"Alicates de presi√≥n",correct:false,whyWrong:"Marcan las tuercas cromadas y pueden deformarlas."},{icon:"ü™õ",label:"Llave Allen",correct:false,whyWrong:"Se usa en tornillos hexagonales internos, no en tuercas."}],explain:"La llave ajustable apoya en caras planas sin morder. Los alicates da√±an y la Allen no aplica."},{task:"Quitar rebabas internas tras cortar el tubo.",options:[{icon:"üõ†Ô∏è",label:"Escariador/desbarbador",correct:true,tip:"P√°salo por dentro y fuera del corte hasta suavizar."},{icon:"üßΩ",label:"Lija de madera",correct:false,whyWrong:"No alcanza bien el interior y deja polvo."},{icon:"üî™",label:"C√∫ter",correct:false,whyWrong:"Inseguro e irregular para el interior del tubo."}],explain:"El escariador elimina rebabas y mejora el asiento. Lija y c√∫ter son imprecisos o peligrosos."},{task:"Cortar un tubo PEX sin aplastarlo.",options:[{icon:"‚úÇÔ∏è",label:"Tijeras para PEX",correct:true,tip:"Corta de un golpe recto; cambia la cuchilla si pierde filo."},{icon:"‚úÇÔ∏è",label:"Cortatubos de cobre",correct:false,whyWrong:"Aplasta el PEX y no corta limpio."},{icon:"üõ†Ô∏è",label:"Tenazas",correct:false,whyWrong:"Deforman y pueden agrietar el material."}],explain:"Las tijeras PEX hacen un corte recto y limpio. El cortatubos de cobre y las tenazas deforman el pl√°stico."}];
let state={i:0,selected:null,answers:[],uiScale:1};
const el={scene:document.getElementById('scene'),ui:document.getElementById('ui'),task:document.getElementById('taskText'),opts:document.getElementById('options'),next:document.getElementById('nextBtn'),stepNum:document.getElementById('stepNum'),bar:document.getElementById('barFill'),status:document.getElementById('statusMsg'),intro:document.getElementById('intro'),results:document.getElementById('results'),recap:document.getElementById('recap'),hits:document.getElementById('hits'),tipsList:document.getElementById('tipsList'),startBtn:document.getElementById('startBtn')};
function clampLabel(s){return s.length>48?s.slice(0,45)+'‚Ä¶':s}
function render(){const it=data[state.i];el.task.textContent=it.task;el.opts.innerHTML='';it.options.forEach((op,idx)=>{const b=document.createElement('button');b.className='option';b.setAttribute('data-idx',idx);b.setAttribute('aria-label',op.label);b.innerHTML=`<span class="icon">${op.icon||'üõ†Ô∏è'}</span><span class="label">${clampLabel(op.label)}</span>`;b.addEventListener('click',onChoose);el.opts.appendChild(b)});el.next.disabled=true;updateHUD();ensureFits()}
function onChoose(e){[...el.opts.children].forEach(b=>b.classList.remove('selected'));const b=e.currentTarget;b.classList.add('selected');state.selected=+b.dataset.idx;el.next.disabled=false;const it=data[state.i];const isOk=it.options[state.selected].correct;showStatus(isOk?`‚úîÔ∏è Bien visto`:`‚ö†Ô∏è Revisa: ${it.options[state.selected].label}`,isOk?'ok':'bad')}
function showStatus(text,type){el.status.textContent=text;el.status.className=`status show ${type==='ok'?'ok':type==='bad'?'bad':'info'}`}
function updateHUD(){el.stepNum.textContent=state.i+1;const p=Math.round((state.i)/data.length*100);el.bar.style.width=`${p}%`}
function confirmStep(){if(state.selected==null)return;const it=data[state.i];const choice=it.options[state.selected];state.answers.push({task:it.task,choice:choice.label,correctLabel:it.options.find(o=>o.correct).label,isCorrect:!!choice.correct,explain:it.explain,wrongs:it.options.filter(o=>!o.correct).map(o=>({label:o.label,why:o.whyWrong||''})),tip:it.options.find(o=>o.correct).tip});flashChoiceFeedback(choice.correct);setTimeout(()=>{state.i++;state.selected=null;if(state.i>=data.length){finish()}else{render();el.status.className='status info';el.status.textContent=''}},220)}
function flashChoiceFeedback(ok){[...el.opts.children].forEach((b,i)=>{const correct=data[state.i].options[i].correct;b.classList.toggle('correct',correct);if(i===state.selected&&!correct)b.classList.add('wrong')})}
function finish(){setTimeout(()=>{buildResults();document.body.classList.remove('no-scroll');document.body.classList.add('results-open');el.results.classList.remove('hidden')},500)}
function buildResults(){const hits=state.answers.filter(a=>a.isCorrect).length;el.hits.textContent=hits;el.recap.innerHTML='';const tipsDict={};state.answers.forEach((a,idx)=>{tipsDict[a.correctLabel]=a.tip;const li=document.createElement('li');const icon=a.isCorrect?'‚úÖ':'‚ùå';li.innerHTML=`<h4>${icon} ${idx+1}. ${a.task}</h4>
<div class="meta">
<span class="pill ${a.isCorrect?'ok':'bad'}">Elegiste: ${clampLabel(a.choice)}</span>
<span class="pill ok">Correcta: ${clampLabel(a.correctLabel)}</span>
</div>
<p style="margin:8px 0 0 0;font-size:14px">${a.explain}</p>
<p style="margin:6px 0 0 0;font-size:13px;color:#0B214A">Otras opciones: ${a.wrongs.map(w=>`${w.label}: ${w.why}`).join(' ¬∑ ')}</p>
`;el.recap.appendChild(li)});el.tipsList.innerHTML='';Object.entries(tipsDict).forEach(([tool,tip])=>{const li=document.createElement('li');li.textContent=`${tool}: ${tip}`;el.tipsList.appendChild(li)})}
el.next.addEventListener('click',confirmStep);
el.startBtn.addEventListener('click',()=>{el.intro.classList.add('hidden');render();requestAnimationFrame(()=>ensureFits())});
function assertNoOverflow(){const s=document.getElementById('scene');return s.scrollHeight<=s.clientHeight}
function applyCompactMode(){document.body.classList.add('compact')}
function fitBoardToViewport(){const r=document.documentElement;const cur=parseInt(getComputedStyle(document.documentElement).getPropertyValue('--cellH'));if(cur>54)r.style.setProperty('--cellH',(cur-8)+'px')}
function autoscaleUI(){const s=document.getElementById('scene');const ui=document.getElementById('ui');ui.style.transform='scale(1)';let scale=Math.max(0.88,Math.min(1,s.clientHeight/ui.scrollHeight));document.documentElement.style.setProperty('--ui-scale',scale.toFixed(3))}
function ensureFits(){document.body.classList.remove('compact');document.documentElement.style.setProperty('--cellH','72px');document.documentElement.style.setProperty('--ui-scale','1');setTimeout(()=>{if(assertNoOverflow())return;applyCompactMode();setTimeout(()=>{if(assertNoOverflow())return;fitBoardToViewport();setTimeout(()=>{if(assertNoOverflow())return;autoscaleUI()},0)},0)},0)}
window.addEventListener('resize',ensureFits);window.addEventListener('orientationchange',ensureFits);
document.addEventListener('DOMContentLoaded',()=>{updateHUD();ensureFits()});
</script>
</body></html>