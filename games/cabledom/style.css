/* ================================================================
   CABLE SORT — Kampe Games — Styles
   ================================================================ */

:root{--navy:#0B214A;--turq:#00E6BC;--lime:#04FFB4;--mint:#C5FFDF;--lemon:#FFFFAB;--fire:#E74C3C;--ok:#27ae60}
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent;-webkit-user-select:none;user-select:none}
html,body{width:100%;height:100%;overflow:hidden;font-family:'Baloo 2',cursive;background:var(--navy);touch-action:none}
body{padding-top:env(safe-area-inset-top);padding-top:constant(safe-area-inset-top);padding-bottom:env(safe-area-inset-bottom);padding-bottom:constant(safe-area-inset-bottom)}
#W{position:relative;width:100%;max-width:430px;margin:0 auto;height:100%;overflow:hidden;background:var(--navy)}
.scr{position:absolute;inset:0;display:flex;flex-direction:column;transition:opacity .35s;z-index:10}
.scr.off{opacity:0;pointer-events:none;z-index:-1}
.bg{position:absolute;inset:0;width:100%;height:100%;object-fit:cover;z-index:0;pointer-events:none}
.dim{position:absolute;inset:0;background:rgba(11,33,74,.8);z-index:1;pointer-events:none}
.btn{background:var(--turq);color:var(--navy);border:none;font-family:'Baloo 2',cursive;font-size:18px;font-weight:700;padding:14px 44px;border-radius:50px;cursor:pointer;box-shadow:0 4px 16px rgba(0,230,188,.3);transition:transform .1s;letter-spacing:.5px}
.btn:active{transform:scale(.96)}

/* ===== INTRO ===== */
#intro{align-items:center;justify-content:flex-end;padding-bottom:24px}
.intro-card{position:relative;z-index:10;display:flex;flex-direction:column;align-items:center;padding:0 20px;width:100%;height:100%}
.intro-title{font-size:28px;font-weight:800;color:#fff;text-shadow:0 3px 16px rgba(0,0,0,.5);margin-top:auto;padding-top:20px;z-index:10;position:relative;flex-shrink:0}
.intro-av{width:100%;max-width:380px;flex:1;min-height:0;object-fit:contain;object-position:bottom;filter:drop-shadow(0 4px 24px rgba(0,0,0,.6));position:relative;z-index:1}
.intro-bub{position:relative;z-index:2;background:#fff;color:var(--navy);padding:16px 20px;border-radius:22px;box-shadow:0 4px 24px rgba(0,0,0,.35);font-size:15px;font-weight:600;line-height:1.4;text-align:center;margin-bottom:14px;width:100%;flex-shrink:0}

/* ===== HUD ===== */
.hud{position:absolute;top:0;left:0;right:0;z-index:50;display:flex;align-items:center;gap:10px;padding:8px 12px;padding-right:66px;background:linear-gradient(180deg,rgba(11,33,74,.95)0%,rgba(11,33,74,.4)80%,transparent 100%);pointer-events:none}
.hud-item{background:rgba(0,0,0,.35);padding:4px 12px;border-radius:14px;color:rgba(255,255,255,.85);font-size:14px;font-weight:600;white-space:nowrap}
.hud-hint{background:rgba(255,255,171,.15);color:var(--lemon);cursor:pointer;pointer-events:auto;transition:all .2s}
.hud-hint:active{transform:scale(.92)}
.hud-hint.disabled{opacity:.3;pointer-events:none}
.hud-hint.pulse{animation:hintBtnPulse 1.5s ease-in-out infinite}
@keyframes hintBtnPulse{0%,100%{box-shadow:0 0 0 0 rgba(255,255,171,0)}50%{box-shadow:0 0 0 6px rgba(255,255,171,.4)}}

/* ===== PLAY BODY ===== */
.play-body{position:relative;z-index:10;flex:1;display:flex;flex-direction:column;padding-top:40px;overflow:hidden}

/* ===== APARATOS ZONE ===== */
.aparatos-row{display:flex;gap:6px;padding:4px 8px;flex-shrink:0;justify-content:center}
.aparato-card{flex:1;min-width:0;max-width:130px;background:rgba(255,255,255,.12);backdrop-filter:blur(4px);-webkit-backdrop-filter:blur(4px);border-radius:16px;padding:8px 6px 10px;display:flex;flex-direction:column;align-items:center;gap:3px;border:2px solid rgba(255,255,255,.08);transition:all .3s;perspective:600px}
.aparato-card.highlight{border-color:var(--turq);box-shadow:0 0 16px rgba(0,230,188,.3)}
.ap-img{width:56px;height:56px;object-fit:contain}
.ap-name{font-size:13px;font-weight:700;color:rgba(255,255,255,.75);text-align:center;line-height:1.1}
.ap-hint{font-size:12px;font-weight:600;color:var(--turq);text-align:center;opacity:.85}
.ap-slots{display:flex;gap:4px;justify-content:center;margin-top:3px;flex-wrap:wrap}
.ap-slot{width:36px;height:50px;border-radius:6px;display:flex;align-items:center;justify-content:center;transition:all .3s;position:relative;border:none;background:transparent}
.term-img{width:100%;height:100%;object-fit:contain;pointer-events:none}
.ap-slot.filled{opacity:.45;transform:scale(.85)}
.ap-slot.filled::after{content:'✓';position:absolute;bottom:-2px;right:-2px;width:16px;height:16px;background:var(--ok);color:#fff;font-size:10px;font-weight:800;border-radius:50%;display:flex;align-items:center;justify-content:center;line-height:1;z-index:2}
.ap-slot.glow{animation:slotGlow .6s ease-out}
@keyframes slotGlow{0%{box-shadow:0 0 10px rgba(0,230,188,.9)}100%{box-shadow:none}}

/* Aparato flip-out animation */
.aparato-card.flip-out{animation:flipOut .4s ease-in forwards}
@keyframes flipOut{
  0%{transform:rotateY(0);opacity:1}
  100%{transform:rotateY(90deg);opacity:0}
}
/* Aparato slide-in from top */
.aparato-card.slide-in{animation:slideInTop .4s ease-out}
@keyframes slideInTop{
  0%{transform:translateY(-100%);opacity:0}
  100%{transform:translateY(0);opacity:1}
}

/* ===== PARKING ROW (cable tray) ===== */
.parking-row{display:flex;gap:8px;justify-content:center;flex-shrink:0;padding:8px 10px;position:relative;background:linear-gradient(180deg,rgba(255,255,255,.08) 0%,rgba(255,255,255,.04) 100%);border-top:1px solid rgba(255,255,255,.12);border-bottom:1px solid rgba(255,255,255,.12)}
.park-slot{width:90px;height:48px;border-radius:10px;display:flex;align-items:center;justify-content:center;transition:all .2s;background:rgba(255,255,255,.08);border:2px dashed rgba(255,255,255,.3);position:relative}
.park-slot.occupied{border-style:solid;border-color:rgba(255,255,255,.1);background:transparent}
.park-slot.highlight{border-color:var(--turq);background:rgba(0,230,188,.1);box-shadow:0 0 12px rgba(0,230,188,.2)}

/* ===== CENTER ZONE (avatar) ===== */
.center-zone{flex:1;display:flex;align-items:flex-end;justify-content:center;min-height:0;position:relative;overflow:hidden}

/* Avatar */
.avatar-img{width:auto;height:100%;max-height:100%;object-fit:contain;filter:drop-shadow(0 4px 16px rgba(0,0,0,.4));transition:opacity .3s;flex-shrink:0;position:absolute;bottom:0;left:-40px;pointer-events:none;z-index:0}

/* ===== COLUMNS ZONE (bottom) ===== */
.columns-row{display:flex;gap:8px;padding:6px 10px 12px;justify-content:center;align-items:flex-end;flex-shrink:0}
.col{flex:1;max-width:90px;display:flex;flex-direction:column;gap:6px;align-items:center}
.col-label{font-size:10px;font-weight:700;color:rgba(255,255,255,.3);text-align:center}
.col-cables{display:flex;flex-direction:column;gap:6px;width:100%}
.col-empty{width:100%;height:48px;border:2px dashed rgba(255,255,255,.1);border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:16px;color:rgba(255,255,255,.15)}

/* ===== CABLE CHIP ===== */
.cable{width:100%;height:48px;border-radius:10px;display:flex;align-items:center;justify-content:center;gap:5px;cursor:grab;position:relative;transition:transform .15s,opacity .15s,box-shadow .15s;font-size:14px;font-weight:700;color:#fff;text-shadow:0 1px 2px rgba(0,0,0,.3)}
.cable.top{opacity:1;box-shadow:0 2px 10px rgba(0,0,0,.35),inset 0 1px 0 rgba(255,255,255,.15)}
.cable.next{opacity:.35;pointer-events:none;cursor:default}
.cable.dragging{opacity:.25}
.cable:active{transform:scale(1.06)}
.cable .sec-dot{border-radius:50%;border:2px solid rgba(255,255,255,.5);flex-shrink:0}
.cable.parking-cable{width:86px;height:44px;font-size:13px}

/* Cable colors */
.cable-marron{background:#8B5E3C;border:2px solid #6B4020}
.cable-azul{background:#2E86C1;border:2px solid #1A5276}
.cable-verde_amarillo{background:repeating-linear-gradient(135deg,#27AE60 0px,#27AE60 5px,#F1C40F 5px,#F1C40F 10px);border:2px solid #1E8449}
.cable-negro{background:#34495E;border:2px solid #1B2631}
.cable-gris{background:#95A5A6;border:2px solid #717D7E}


/* ===== DRAG GHOST ===== */
.drag-ghost{position:fixed;z-index:500;pointer-events:none;transition:none;display:none}
.drag-ghost.active{display:flex}

/* ===== CHAR MESSAGE (speech bubble from avatar) ===== */
.char-msg{position:absolute;right:6px;transform:translateY(10px);z-index:90;display:flex;align-items:flex-end;gap:8px;opacity:0;transition:all .3s ease-out;pointer-events:none}
.char-msg.show{opacity:1;transform:translateY(0)}
.char-msg-bubble{background:#fff;color:var(--navy);padding:12px 16px;border-radius:16px;font-size:15px;font-weight:600;line-height:1.35;box-shadow:0 4px 16px rgba(0,0,0,.3);flex:1;position:relative}
.char-msg-bubble::after{content:'';position:absolute;top:50%;left:-6px;width:12px;height:12px;background:#fff;border-radius:2px;transform:translateY(-50%) rotate(45deg)}

/* ===== CONTEXTUAL HINT (highlight zone) ===== */
.hint-glow{animation:hintPulse 1.5s ease-in-out 3;position:relative;z-index:2}
@keyframes hintPulse{
  0%,100%{box-shadow:0 0 0 0 rgba(0,230,188,0)}
  50%{box-shadow:0 0 0 6px rgba(0,230,188,.4)}
}

/* ===== EDUCATIONAL OVERLAY (dim blocker) ===== */
.edu-overlay{position:absolute;inset:0;background:rgba(0,0,0,.55);z-index:70;display:none}
.edu-overlay.show{display:block}
.edu-btn{display:block;margin:10px auto 0;background:var(--navy);color:#fff;border:none;font-family:'Baloo 2',cursive;font-size:14px;font-weight:700;padding:8px 28px;border-radius:50px;cursor:pointer;pointer-events:auto}
.edu-btn:active{transform:scale(.96)}

/* ===== ESCAPE BUTTON ===== */
.escape-btn{position:absolute;top:44px;left:50%;transform:translateX(-50%);z-index:60;background:rgba(231,76,60,.9);color:#fff;border:none;font-family:'Baloo 2',cursive;font-size:13px;font-weight:700;padding:8px 18px;border-radius:20px;cursor:pointer;display:none;animation:escapePulse 1.5s infinite}
@keyframes escapePulse{0%,100%{box-shadow:0 0 0 0 rgba(231,76,60,.4)}50%{box-shadow:0 0 0 8px rgba(231,76,60,0)}}

/* ===== RESULTS ===== */
#results{align-items:center;justify-content:center;padding:16px 20px;z-index:200;background:var(--navy)}
.res-inner{position:relative;z-index:10;display:flex;flex-direction:column;align-items:center;width:100%;gap:4px}
.res-badge{color:var(--lime);font-size:16px;font-weight:800;letter-spacing:1px;text-transform:uppercase;margin-bottom:4px}
.res-scores{display:flex;gap:28px;margin-bottom:4px}
.res-col{text-align:center}
.res-val{font-size:38px;font-weight:800;color:var(--lime)}
.res-label{font-size:12px;color:rgba(255,255,255,.5);font-weight:600}
.res-new{color:var(--lemon);font-size:15px;font-weight:800;display:none}
.res-new.show{display:block}
.res-av{width:160px;height:210px;object-fit:contain;filter:drop-shadow(0 4px 22px rgba(0,0,0,.5));margin-bottom:-16px;position:relative;z-index:1}
.res-info{background:rgba(255,255,255,.1);border-radius:18px;padding:18px 22px;width:100%;max-width:340px;display:flex;flex-direction:column;align-items:center;gap:8px}
.res-msg{color:#fff;font-size:15px;font-weight:600;text-align:center;line-height:1.3}
.res-stats{color:rgba(255,255,255,.6);font-size:14px;font-weight:600}
.res-bot{margin-top:12px}

/* ===== ANIMATIONS ===== */
@keyframes shake{0%,100%{transform:translateX(0)}20%{transform:translateX(-8px)}40%{transform:translateX(8px)}60%{transform:translateX(-6px)}80%{transform:translateX(4px)}}
.shake{animation:shake .4s ease-out}
@keyframes slideUp{from{transform:translateY(54px);opacity:0}to{transform:translateY(0);opacity:1}}
.slide-up{animation:slideUp .3s ease-out}
@keyframes popIn{from{transform:scale(.8);opacity:0}to{transform:scale(1);opacity:1}}
.pop-in{animation:popIn .25s ease-out}
